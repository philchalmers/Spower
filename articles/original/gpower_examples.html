<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>G*Power examples evaluated with Spower • Spower</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="G*Power examples evaluated with Spower">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">Spower</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../../articles/gpower_examples.html">G*Power examples evaluated with Spower</a></li>
    <li><a class="dropdown-item" href="../../articles/original/gpower_examples.html">G*Power examples evaluated with Spower</a></li>
    <li><a class="dropdown-item" href="../../articles/Spower_TypeSM.html">Type M and Type S errors</a></li>
    <li><a class="dropdown-item" href="../../articles/SpowerIntro_logicals.html">Logical Vectors, Bayesian power analyses, and ROPEs</a></li>
    <li><a class="dropdown-item" href="../../articles/SpowerIntro.html">Introduction to the Spower package</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/Spower/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>G*Power examples evaluated with Spower</h1>
                        <h4 data-toc-skip class="author">Phil
Chalmers</h4>
            
            <h4 data-toc-skip class="date">2026-02-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/Spower/blob/main/vignettes/original/gpower_examples.Rmd" class="external-link"><code>vignettes/original/gpower_examples.Rmd</code></a></small>
      <div class="d-none name"><code>gpower_examples.Rmd</code></div>
    </div>

    
    
<p>This vignette replicates several of the examples found in the G*Power
manual (version 3.1). It is not meant to be exhaustive, but instead
demonstrates how the presented power analyses can be computed and
extended using simulation methodology by either editing the default
functions found within the package, or by creating a new user-defined
function for yet-to-be-defined statistical analysis contexts. Unless
otherwise specified, the following analyses assume that the
“significance level” (<code>sig.level</code> in <code><a href="../../reference/Spower.html">Spower()</a></code>)
is set to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>.05</mn></mrow><annotation encoding="application/x-tex">\alpha = .05</annotation></semantics></math>.</p>
<div class="section level2">
<h2 id="correlation">Correlation<a class="anchor" aria-label="anchor" href="#correlation"></a>
</h2>
<p>Correlation analyses require evaluating the power associated with the
hypotheses
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><mi>ρ</mi><mo>−</mo><msub><mi>ρ</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\, \rho-\rho_0=0</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><mi>ρ</mi><mo>−</mo><msub><mi>ρ</mi><mn>0</mn></msub><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_1:\, \rho-\rho_0\ne 0</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
is the population correlation and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\rho_0</annotation></semantics></math>
the null hypothesis constant.</p>
<div class="section level4">
<h4 id="example-3-3-difference-from-constant-one-sample-case">Example 3.3; Difference from constant (one sample case)<a class="anchor" aria-label="anchor" href="#example-3-3-difference-from-constant-one-sample-case"></a>
</h4>
<p>The following estimates the sample size required to reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><msub><mi>ρ</mi><mn>0</mn></msub><mo>=</mo><mn>.60</mn></mrow><annotation encoding="application/x-tex">H_0:\, \rho_0=.60</annotation></semantics></math>
in correlation analysis with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.95</mn></mrow><annotation encoding="application/x-tex">1-\beta=.95</annotation></semantics></math>
probability when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>.65</mn></mrow><annotation encoding="application/x-tex">\rho=.65</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_r.html">p_r</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">3000</span><span class="op">)</span>, r <span class="op">=</span> <span class="fl">.65</span>, rho <span class="op">=</span> <span class="fl">.60</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:16</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n     r   rho sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>  0.65   0.6      0.05  0.95</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 1931.4</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [1901.1, 1958.2]</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this is equivalent:</span></span>
<span><span class="co"># p_r(n = NA, r = .65, rho = .60) |&gt; </span></span>
<span><span class="co">#   Spower(power = .95, interval=c(500,3000))</span></span></code></pre></div>
<p>G*power estimates this
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
to be 1929 using the Fisher
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>-transformation
approximation, which is what is used by the <code>Spower</code>
definition as well.</p>
</div>
<div class="section level4">
<h4 id="test-against-constant-rho_00">Test against constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho_0=0</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#test-against-constant-rho_00"></a>
</h4>
<p>The more canonical version hypotheses involving correlation
coefficients appear when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>h</mi><msub><mi>o</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">rho_0=0</annotation></semantics></math>,
as these do not require the Fisher approximation. For instance, the
power associated with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>.3</mn></mrow><annotation encoding="application/x-tex">\rho = .3</annotation></semantics></math>
with 100 pairs of observations, tested against
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho_0=0</annotation></semantics></math>,
results in the following.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_r.html">p_r</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, r <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:08</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n     r sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   100   0.3      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.861</span></span>
<span><span class="co">## 95% Confidence Interval: [0.854, 0.867]</span></span></code></pre>
<p>Next, the sample sample size estimate required to reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><msub><mi>ρ</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\, \rho_0=0</annotation></semantics></math>
in correlation analysis with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.95</mn></mrow><annotation encoding="application/x-tex">1-\beta=.95</annotation></semantics></math>
probability when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>.3</mn></mrow><annotation encoding="application/x-tex">\rho=.3</annotation></semantics></math>
is expressed as</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_r.html">p_r</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">1000</span><span class="op">)</span>, r <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:13</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n     r sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.3      0.05  0.95</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 138.3</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [136.1, 140.4]</span></span></code></pre>
<p>G*power 3.1 provides the same estimate as the <code>pwr</code>
package in this case, which for comparison is presented below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pwr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.r.test.html" class="external-link">pwr.r.test</a></span><span class="op">(</span>r<span class="op">=</span><span class="fl">.3</span>, power<span class="op">=</span><span class="fl">.95</span>, n<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##      approximate correlation power calculation (arctangh transformation) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##               n = 137.8</span></span>
<span><span class="co">##               r = 0.3</span></span>
<span><span class="co">##       sig.level = 0.05</span></span>
<span><span class="co">##           power = 0.95</span></span>
<span><span class="co">##     alternative = two.sided</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="example-27-3-correlation---inequality-of-two-independent-pearson-rs">Example 27.3; Correlation - inequality of two independent Pearson
r’s<a class="anchor" aria-label="anchor" href="#example-27-3-correlation---inequality-of-two-independent-pearson-rs"></a>
</h4>
<p>Were the correlation between two independent samples to be compared,
the <code><a href="../../reference/p_2r.html">p_2r()</a></code> simulation can be adopted. Below a sample of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>1</mn></msub><mo>=</mo><mn>206</mn></mrow><annotation encoding="application/x-tex">N_1=206</annotation></semantics></math>
observations appeared in the first sample
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>.75</mn></mrow><annotation encoding="application/x-tex">r=.75</annotation></semantics></math>),
while the second sample
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>.88</mn></mrow><annotation encoding="application/x-tex">r=.88</annotation></semantics></math>)
contained only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>2</mn></msub><mo>=</mo><mn>51</mn></mrow><annotation encoding="application/x-tex">N_2=51</annotation></semantics></math>
observations (hence, the ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>2</mn></msub><mi>/</mi><msub><mi>N</mi><mn>1</mn></msub><mo>=</mo><mn>51</mn><mi>/</mi><mn>206</mn></mrow><annotation encoding="application/x-tex">N_2/N_1=51/206</annotation></semantics></math>).
This results in the post-hoc/observed power of</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_2r.html">p_2r</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">206</span>, r.ab<span class="op">=</span><span class="fl">.75</span>, r.ab2<span class="op">=</span><span class="fl">.88</span>, n2_n1<span class="op">=</span><span class="fl">51</span><span class="op">/</span><span class="fl">206</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:19</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n  r.ab r.ab2 sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   206  0.75  0.88      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.727</span></span>
<span><span class="co">## 95% Confidence Interval: [0.718, 0.735]</span></span></code></pre>
<p>G*power 3.1 returns the power of .726 in this context.</p>
</div>
<div class="section level4">
<h4 id="example-28-3-1-correlation---inequality-of-two-dependent-pearson-rs-no-common-index">Example 28.3.1; Correlation - inequality of two dependent Pearson
r’s (no common index)<a class="anchor" aria-label="anchor" href="#example-28-3-1-correlation---inequality-of-two-dependent-pearson-rs-no-common-index"></a>
</h4>
<p>The following two examples assume the correlation matrix</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># From Gpower 3.1 manual</span></span>
<span><span class="va">Cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span>, <span class="fl">.4</span>, <span class="fl">.1</span>, </span>
<span>               <span class="fl">.5</span>, <span class="fl">1</span>, <span class="fl">.2</span>, <span class="op">-</span><span class="fl">.4</span>, </span>
<span>               <span class="fl">.4</span>, <span class="fl">.2</span>, <span class="fl">1</span>, <span class="fl">.8</span>, </span>
<span>               <span class="fl">.1</span>, <span class="op">-</span><span class="fl">.4</span>, <span class="fl">.8</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># rearrange rows for convenience</span></span>
<span><span class="va">Cp</span> <span class="op">&lt;-</span> <span class="va">Cp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Cp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Cp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x1'</span>, <span class="st">'y1'</span>, <span class="st">'x2'</span>, <span class="st">'y2'</span><span class="op">)</span></span>
<span><span class="va">Cp</span></span></code></pre></div>
<pre><code><span><span class="co">##     x1   y1   x2  y2</span></span>
<span><span class="co">## x1 1.0  0.1  0.5 0.4</span></span>
<span><span class="co">## y1 0.1  1.0 -0.4 0.8</span></span>
<span><span class="co">## x2 0.5 -0.4  1.0 0.2</span></span>
<span><span class="co">## y2 0.4  0.8  0.2 1.0</span></span></code></pre>
<p>is the population structure. For the no common index tests all of
these elements are required, while for the common index form only a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">3\times 3</annotation></semantics></math>
subset is needed.</p>
<p>Evaluating the null hypothesis that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>ρ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><msub><mi>ρ</mi><mrow><mi>c</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_0: \rho_{ab} = \rho_{cd}</annotation></semantics></math>
where in this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><mn>.5</mn></mrow><annotation encoding="application/x-tex">\rho_{ab} = .5</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>c</mi><mi>d</mi></mrow></msub><mo>=</mo><mn>.8</mn></mrow><annotation encoding="application/x-tex">\rho_{cd} = .8</annotation></semantics></math>
can be explored using the <code><a href="../../reference/p_2r.html">p_2r()</a></code> function. The following
performs an a priori analyses to determine the sample size
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>)
required to achieve 80% power using Steiger’s (1980) inferential
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
approach.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_2r.html">p_2r</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">2000</span><span class="op">)</span>, r.ab<span class="op">=</span><span class="fl">.1</span>, r.ac<span class="op">=</span><span class="fl">.5</span>, r.ad<span class="op">=</span><span class="fl">.4</span>, r.bc<span class="op">=</span><span class="op">-</span><span class="fl">.4</span>, r.bd<span class="op">=</span><span class="fl">.8</span>, r.cd<span class="op">=</span><span class="fl">.2</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">.80</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:01:13</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">##       n  r.ab  r.ac  r.ad  r.bd  r.cd two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.1   0.5   0.4   0.8   0.2 FALSE           0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 886.2</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [875.3, 897.3]</span></span></code></pre>
<p>G*power 3.1 returns the required sample size of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>886</mn></mrow><annotation encoding="application/x-tex">N=886</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="example-28-3-2-correlation---inequality-of-two-dependent-pearson-rs-common-index">Example 28.3.2; Correlation - inequality of two dependent Pearson
r’s (common index)<a class="anchor" aria-label="anchor" href="#example-28-3-2-correlation---inequality-of-two-dependent-pearson-rs-common-index"></a>
</h4>
<p>The information in this example is the same as
<code>Example 28.3.1</code>, however it is assumed that there is a
common index between the correlation measures instead of a complete
overlap. As such, the previous <code>Cp</code> object may be further
subset to see what type of correlation structure is required for the
common index setup.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Cp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##     y2  x2  x1</span></span>
<span><span class="co">## y2 1.0 0.2 0.4</span></span>
<span><span class="co">## x2 0.2 1.0 0.5</span></span>
<span><span class="co">## x1 0.4 0.5 1.0</span></span></code></pre>
<p>The null under instigation in this case is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>ρ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><msub><mi>ρ</mi><mrow><mi>a</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_0:\rho_{ab} = \rho_{ac}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><mn>.2</mn></mrow><annotation encoding="application/x-tex">\rho_{ab} = .2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>a</mi><mi>c</mi></mrow></msub><mo>=</mo><mn>.4</mn></mrow><annotation encoding="application/x-tex">\rho_{ac} = .4</annotation></semantics></math>.
In <code>Spower</code>, this equates to the following inputs, which
again use Steiger’s (1980) inferential
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
approach by default.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_2r.html">p_2r</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">500</span><span class="op">)</span>, r.ab<span class="op">=</span><span class="fl">.4</span>, r.ac<span class="op">=</span><span class="fl">.2</span>, r.bc<span class="op">=</span><span class="fl">.5</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">.80</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:01:00</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">##       n  r.ab  r.ac  r.bc two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.4   0.2   0.5 FALSE           0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 134.7</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [133.1, 136.3]</span></span></code></pre>
<p>G*power 3.1 returns the required sample size of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>144</mn></mrow><annotation encoding="application/x-tex">N=144</annotation></semantics></math>,
which interestingly is slightly higher than the simulation version from
<code>Spower</code>. Providing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>144</mn></mrow><annotation encoding="application/x-tex">N=144</annotation></semantics></math>
to the above to obtain the power estimate gives the following:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_2r.html">p_2r</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">144</span>, r.ab<span class="op">=</span><span class="fl">.4</span>, r.ac<span class="op">=</span><span class="fl">.2</span>, r.bc<span class="op">=</span><span class="fl">.5</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:15</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">##       n  r.ab  r.ac  r.bc two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   144   0.4   0.2   0.5 FALSE           0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.831</span></span>
<span><span class="co">## 95% Confidence Interval: [0.824, 0.839]</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="example-28-3-3-sensitivity-analysis">Example 28.3.3; sensitivity analysis<a class="anchor" aria-label="anchor" href="#example-28-3-3-sensitivity-analysis"></a>
</h4>
<p>It is also possible to perform a sensitivity analyses rather than the
above a priori power analysis. Below fixes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>144</mn></mrow><annotation encoding="application/x-tex">N=144</annotation></semantics></math>,
while <code>r.ac</code> is solved to obtain 80% power. G*power 3.1
reports that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>a</mi><mi>c</mi></mrow></msub><mo>=</mo><mn>0.047702</mn></mrow><annotation encoding="application/x-tex">\rho_{ac} = 0.047702</annotation></semantics></math>,
which is confirmed using the simulation below.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># confirm solution obtained by G*power (post hoc power estimate)</span></span>
<span><span class="fu"><a href="../../reference/p_2r.html">p_2r</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">144</span>, r.ab<span class="op">=</span><span class="fl">.4</span>, r.ac<span class="op">=</span><span class="fl">0.047702</span>, r.bc<span class="op">=</span><span class="op">-</span><span class="fl">0.6</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:15</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##       n  r.ab     r.ac two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   144   0.4 0.047<span style="text-decoration: underline;">702</span> FALSE           0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.815</span></span>
<span><span class="co">## 95% Confidence Interval: [0.808, 0.823]</span></span></code></pre>
<p>Obtaining a similar estimate using <code><a href="../../reference/Spower.html">Spower()</a></code> requires the
following sensitivity analysis structure:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># note that interval is specified as c(upper, lower) as higher values</span></span>
<span><span class="co"># of r.ac result in lower power in this context</span></span>
<span><span class="fu"><a href="../../reference/p_2r.html">p_2r</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">144</span>, r.ab<span class="op">=</span><span class="fl">.4</span>, r.ac<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">.001</span><span class="op">)</span>, r.bc<span class="op">=</span><span class="op">-</span><span class="fl">0.6</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">.80</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:01:14</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##       n  r.ab  r.ac two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   144   0.4    <span style="color: #BB0000;">NA</span> FALSE           0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of r.ac: 0.048</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [0.046, 0.050]</span></span></code></pre>
<p>For this example, <code>Spower</code> and G*power 3.1 seem to
agree.</p>
</div>
<div class="section level4">
<h4 id="example-16-3-point-biserial-correlation">Example 16.3; Point-biserial correlation<a class="anchor" aria-label="anchor" href="#example-16-3-point-biserial-correlation"></a>
</h4>
<p>The following estimates the sample size required to obtain a power of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.95</mn></mrow><annotation encoding="application/x-tex">1-\beta=.95</annotation></semantics></math>
given that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>.25</mn></mrow><annotation encoding="application/x-tex">r=.25</annotation></semantics></math>
is the true correlation, evaluated under the null
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>ρ</mi><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\rho\le0</annotation></semantics></math>
(hence, is one-tailed) with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>.05</mn></mrow><annotation encoding="application/x-tex">\alpha = .05</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># solution per group</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">.25</span>, n <span class="op">=</span> <span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">200</span><span class="op">)</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span>
<span><span class="va">out</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:08</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n     r two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>  0.25 FALSE           0.05  0.95</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 81.7</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [79.1, 85.4]</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># total sample size required</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 164</span></span></code></pre>
<p>G*power gives the result
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>164</mn></mrow><annotation encoding="application/x-tex">N=164</annotation></semantics></math>.</p>
<p>Relatedly, one can specify
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>,
Cohen’s standardized mean-difference effect size, instead of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
will be converted to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
inside the <code><a href="../../reference/p_t.test.html">p_t.test()</a></code> function.</p>
</div>
<div class="section level4">
<h4 id="example-31-3-tetrachoric-correlation">Example 31.3; tetrachoric correlation<a class="anchor" aria-label="anchor" href="#example-31-3-tetrachoric-correlation"></a>
</h4>
<p>For tetrachoric and polychoric correlations, the experiment
definition in <code><a href="../../reference/p_r.cat.html">p_r.cat()</a></code> can be used. This requires
specifying the associated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
threshold coefficients for the population normal truncation processes,
as well as the bivariate correlation itself prior to the truncation.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">203</span>, <span class="fl">186</span>, <span class="fl">167</span>, <span class="fl">374</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="cn">F</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">marginal.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="cn">F</span><span class="op">)</span><span class="op">/</span><span class="va">N</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.4183 0.5817</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">marginal.y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="cn">F</span><span class="op">)</span><span class="op">/</span><span class="va">N</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.3978 0.6022</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># converted to intercepts</span></span>
<span><span class="va">tauX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">marginal.x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">tauY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">marginal.y</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tauX</span>, <span class="va">tauY</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.2063 -0.2589</span></span></code></pre>
<p>These
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
values correspond to where along the assumed normal p.d.f. the
truncation took place, which for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
variable can be seen in the following graphic.</p>
<div class="float">
<img src="tetrachoric.png" alt="Tetrachoric"><div class="figcaption">Tetrachoric</div>
</div>
<p>Finally, assuming that the untruncated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0.2399846</mn></mrow><annotation encoding="application/x-tex">r=0.2399846</annotation></semantics></math>,
and a Score test were used to evaluate the null hypothesis of interest
(<code>score = TRUE</code>), the sample size required to reject the null
hypothesis that the tetrachoric correlation is less than or equal to 0
in this population (one-tailed) is expressed as</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_r.cat.html">p_r.cat</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span><span class="op">)</span>, r<span class="op">=</span><span class="fl">0.2399846</span>, tauX<span class="op">=</span><span class="va">tauX</span>, tauY<span class="op">=</span><span class="va">tauY</span>, </span>
<span>        score<span class="op">=</span><span class="cn">TRUE</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">.95</span>, parallel<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # A tibble: 1 × 8</span></span>
<span><span class="co">##       n     r   tauX   tauY score two.tailed sig.level power</span></span>
<span><span class="co">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt;          &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">## 1    NA 0.240 -0.206 -0.259 FALSE FALSE           0.05  0.95</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 462.9</span></span>
<span><span class="co">## 95% Prediction Interval: [458.5, 466.6]</span></span></code></pre>
<p>G*power gives
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>463</mn></mrow><annotation encoding="application/x-tex">n=463</annotation></semantics></math>,
though uses the SE value at the null (Score test).
<code><a href="../../reference/p_r.cat.html">p_r.cat()</a></code>, on the other hand, defaults to the Wald approach
where the SE is at the maximum-likelihood estimate (MLE); hence,
<code>score = FALSE</code> by default. To switch, use
<code>score=TRUE</code>, though note that this requires twice as many
computations as a second set of data is generated and analyzed at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><msub><mi>r</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">r=r_0</annotation></semantics></math>
to obtain the required
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msub><mi>E</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">SE_0</annotation></semantics></math>
estimate.</p>
</div>
</div>
<div class="section level2">
<h2 id="proportions">Proportions<a class="anchor" aria-label="anchor" href="#proportions"></a>
</h2>
<div class="section level4">
<h4 id="example-4-3-one-sample-proportion-tests">Example 4.3; One sample proportion tests<a class="anchor" aria-label="anchor" href="#example-4-3-one-sample-proportion-tests"></a>
</h4>
<p>A one sample, one-tailed proportion test given data generated from a
population with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo>=</mo><mn>.80</mn></mrow><annotation encoding="application/x-tex">\pi = .80</annotation></semantics></math>
and tested against the null hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>π</mi><mn>0</mn></msub><mo>≤</mo><mn>.65</mn></mrow><annotation encoding="application/x-tex">H_0:\pi_0\le.65</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">n=20</annotation></semantics></math>
is presented in the following. Note that G*power requires a term
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
to be specified as the proportion <em>difference</em> from the null
instead (hence,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><mn>.80</mn><mo>−</mo><mn>.65</mn><mo>=</mo><mn>.15</mn></mrow><annotation encoding="application/x-tex">g = .80-.65=.15</annotation></semantics></math>),
though <code>p_prop.teset()</code> accepts the null and alternative
probability values as-is.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pi</span> <span class="op">&lt;-</span> <span class="fl">.65</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fl">.15</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">pi</span> <span class="op">+</span> <span class="va">g</span></span>
<span></span>
<span><span class="fu"><a href="../../reference/p_prop.test.html">p_prop.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span>, prop<span class="op">=</span><span class="va">p</span>, pi<span class="op">=</span><span class="va">pi</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:02</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    20 FALSE           0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.416</span></span>
<span><span class="co">## 95% Confidence Interval: [0.406, 0.425]</span></span></code></pre>
<p>G*power gives the estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.4112</mn></mrow><annotation encoding="application/x-tex">1-\beta=.4112</annotation></semantics></math>.
Note that with <code><a href="../../reference/p_prop.test.html">p_prop.test()</a></code>, the Fisher’s exact version of
this test is also supported by passing the argument
<code>exact = TRUE</code>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fisher exact test</span></span>
<span><span class="fu"><a href="../../reference/p_prop.test.html">p_prop.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span>, prop<span class="op">=</span><span class="va">p</span>, pi<span class="op">=</span><span class="va">pi</span>, exact<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>            two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:02</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n two.tailed exact sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    20 FALSE      TRUE       0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.411</span></span>
<span><span class="co">## 95% Confidence Interval: [0.402, 0.421]</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="example-22-1-wilcoxon-signed-rank-test">Example 22.1; Wilcoxon signed-rank test<a class="anchor" aria-label="anchor" href="#example-22-1-wilcoxon-signed-rank-test"></a>
</h4>
<p>The following performed a one-sample, one-tailed Wilcoxon signed rank
test given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>649</mn></mrow><annotation encoding="application/x-tex">N=649</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>.1</mn></mrow><annotation encoding="application/x-tex">d=.1</annotation></semantics></math>,
where the parent distribution is assumed to follow a Normal/Gaussian
shape (default).</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_wilcox.test.html">p_wilcox.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">649</span>, d<span class="op">=</span><span class="fl">.1</span>, type<span class="op">=</span><span class="st">'one.sample'</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:13</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##       n     d type       two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   649   0.1 one.sample FALSE           0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.812</span></span>
<span><span class="co">## 95% Confidence Interval: [0.805, 0.820]</span></span></code></pre>
<p>G*power gives the power estimate of .800.</p>
<p>The following partially recreates the simulation results in Figure 29
(which itself was partially extracted from Shieh, Jan, and Randles,
2007) for the
<em>Gaussian(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>,1)</em>
distribution with varying sample sizes and effect sizes. The target was
to obtain the “approximate power of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.80</mn></mrow><annotation encoding="application/x-tex">1-\beta = .80</annotation></semantics></math>”,
though how these sample sizes were decided upon was not specified.
<code><a href="../../reference/Spower.html">Spower()</a></code>’s stochastic root-solving approach would likely
get closer to more optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
estimates were these the target of the analyses.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For Gaussian(d,1)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/p_wilcox.test.html">p_wilcox.test</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'one.sample'</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">SpowerBatch</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">649</span>, <span class="fl">164</span>, <span class="fl">42</span>, <span class="fl">20</span>, <span class="fl">12</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>                d<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.4</span>, <span class="fl">.6</span>, <span class="fl">.8</span>, <span class="fl">1.0</span><span class="op">)</span>, replications <span class="op">=</span> <span class="fl">50000</span>, fully.crossed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     n   d       type two.tailed sig.level  power CI_2.5 CI_97.5</span></span>
<span><span class="co">## 1 649 0.1 one.sample      FALSE      0.05 0.8012 0.7977  0.8047</span></span>
<span><span class="co">## 2 164 0.2 one.sample      FALSE      0.05 0.8027 0.7992  0.8062</span></span>
<span><span class="co">## 3  42 0.4 one.sample      FALSE      0.05 0.8043 0.8009  0.8078</span></span>
<span><span class="co">## 4  20 0.6 one.sample      FALSE      0.05 0.8070 0.8035  0.8105</span></span>
<span><span class="co">## 5  12 0.8 one.sample      FALSE      0.05 0.8018 0.7983  0.8053</span></span>
<span><span class="co">## 6   9 1.0 one.sample      FALSE      0.05 0.8467 0.8435  0.8498</span></span></code></pre>
<div class="section level5">
<h5 id="laplacemu-1-version">Laplace(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>,
1) version<a class="anchor" aria-label="anchor" href="#laplacemu-1-version"></a>
</h5>
<p>A one-sample Wilcoxon signed rank test with Laplace distribution as
the parent. Note that this requires defining the parent distribution
manually, accepting arguments such as <code>n</code> and
<code>d</code>.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sigbertklinke/extraDistr" class="external-link">extraDistr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate data with scale 0-1 for d effect size to be same as mean</span></span>
<span><span class="co"># VAR = 2*b^2, so scale should be 1 = 2*b^2 -&gt; sqrt(1/2)</span></span>
<span><span class="va">parent</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">d</span>, <span class="va">sigma</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Laplace.html" class="external-link">rlaplace</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">d</span>, sigma<span class="op">=</span><span class="va">sigma</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../../reference/p_wilcox.test.html">p_wilcox.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">11</span>, d<span class="op">=</span><span class="fl">.8</span>, parent1<span class="op">=</span><span class="va">parent</span>, type<span class="op">=</span><span class="st">'one.sample'</span>,</span>
<span>              two.tailed<span class="op">=</span><span class="cn">FALSE</span>, correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:02</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">##       n     d type       correct two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    11   0.8 one.sample FALSE   FALSE           0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.801</span></span>
<span><span class="co">## 95% Confidence Interval: [0.793, 0.809]</span></span></code></pre>
<p>G*power gives the estimate .830, which seems somewhat high (see
below).</p>
<p>The following partially recreates the simulation results in Figure 29
for the
Laplace(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>,
1) distribution with varying sample sizes and effect sizes. The target
was to obtain “approximate power of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.80</mn></mrow><annotation encoding="application/x-tex">1-\beta = .80</annotation></semantics></math>”,
though how these sample sizes were decided upon was not specified.
<code><a href="../../reference/Spower.html">Spower()</a></code>’s stochastic root-solving approach would likely
get closer to more optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
estimates were these the target of the analyses.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For Laplace(0,1)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/p_wilcox.test.html">p_wilcox.test</a></span><span class="op">(</span>parent1<span class="op">=</span><span class="va">parent</span>, type<span class="op">=</span><span class="st">'one.sample'</span>,</span>
<span>              two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">SpowerBatch</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">419</span>, <span class="fl">109</span>, <span class="fl">31</span>, <span class="fl">16</span>, <span class="fl">11</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>                d<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.4</span>, <span class="fl">.6</span>, <span class="fl">.8</span>, <span class="fl">1.0</span><span class="op">)</span>, replications<span class="op">=</span><span class="fl">50000</span>, fully.crossed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     n   d       type two.tailed sig.level  power CI_2.5 CI_97.5</span></span>
<span><span class="co">## 1 419 0.1 one.sample      FALSE      0.05 0.8021 0.7986  0.8056</span></span>
<span><span class="co">## 2 109 0.2 one.sample      FALSE      0.05 0.7992 0.7957  0.8028</span></span>
<span><span class="co">## 3  31 0.4 one.sample      FALSE      0.05 0.8031 0.7996  0.8065</span></span>
<span><span class="co">## 4  16 0.6 one.sample      FALSE      0.05 0.8007 0.7972  0.8042</span></span>
<span><span class="co">## 5  11 0.8 one.sample      FALSE      0.05 0.8032 0.7998  0.8067</span></span>
<span><span class="co">## 6   8 1.0 one.sample      FALSE      0.05 0.7771 0.7735  0.7808</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="example-5-3-two-dependent-proportions-test-mcnemars-test">Example 5.3; Two dependent proportions test (McNemar’s test)<a class="anchor" aria-label="anchor" href="#example-5-3-two-dependent-proportions-test-mcnemars-test"></a>
</h4>
<p>The following performs a proportions test between two dependent
groups using McNemar’s test. The data is from O’Brien (2002,
p. 161-163).</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obrien2002</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.54</span>, <span class="fl">.32</span>, <span class="fl">.08</span>, <span class="fl">.06</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span>,</span>
<span>                     dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">'Treatment'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Yes'</span>, <span class="st">'No'</span><span class="op">)</span>,</span>
<span>                                    <span class="st">'Standard'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Yes'</span>, <span class="st">'No'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">obrien2002</span></span></code></pre></div>
<pre><code><span><span class="co">##          Standard</span></span>
<span><span class="co">## Treatment  Yes   No</span></span>
<span><span class="co">##       Yes 0.54 0.08</span></span>
<span><span class="co">##       No  0.32 0.06</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_mcnemar.test.html">p_mcnemar.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, prop<span class="op">=</span><span class="va">obrien2002</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:01</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    50 FALSE           0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.836</span></span>
<span><span class="co">## 95% Confidence Interval: [0.828, 0.843]</span></span></code></pre>
<p>Alternatively, specifying the inputs not in terms of proportions but
rather as the odds ratio
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>R</mi><mo>=</mo><msub><mi>π</mi><mn>12</mn></msub><mi>/</mi><msub><mi>π</mi><mn>21</mn></msub><mo>=</mo><mn>.08</mn><mi>/</mi><mn>.32</mn><mo>=</mo><mn>.25</mn></mrow><annotation encoding="application/x-tex">OR=\pi_{12}/\pi_{21}=.08/.32=.25</annotation></semantics></math>)
and proportions of discordant pairs
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>D</mi></msub><mo>=</mo><msub><mi>π</mi><mn>12</mn></msub><mo>+</mo><msub><mi>π</mi><mn>21</mn></msub><mo>=</mo><mn>.08</mn><mo>+</mo><mn>.32</mn><mo>=</mo><mn>.40</mn></mrow><annotation encoding="application/x-tex">\pi_D=\pi_{12} + \pi_{21}=.08 + .32=.40</annotation></semantics></math>)
can be supplied</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OR</span> <span class="op">&lt;-</span> <span class="va">obrien2002</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="va">obrien2002</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">disc</span> <span class="op">&lt;-</span> <span class="va">obrien2002</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">obrien2002</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="../../reference/p_mcnemar.test.html">p_mcnemar.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, OR<span class="op">=</span><span class="va">OR</span>, prop.disc<span class="op">=</span><span class="va">disc</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:01</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    50 FALSE           0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.841</span></span>
<span><span class="co">## 95% Confidence Interval: [0.834, 0.848]</span></span></code></pre>
<p>G*Power gives .839
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>.032</mn></mrow><annotation encoding="application/x-tex">\alpha = .032</annotation></semantics></math>).
Slightly more power can be achieved when not using the continuity
correction, though in general this is not recommended in practice.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_mcnemar.test.html">p_mcnemar.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, prop<span class="op">=</span><span class="va">obrien2002</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span>, correct<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:01</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n two.tailed correct sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    50 FALSE      FALSE        0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.887</span></span>
<span><span class="co">## 95% Confidence Interval: [0.881, 0.893]</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="multiple-linear-regression-fixed-ivs">Multiple Linear Regression (Fixed IVs)<a class="anchor" aria-label="anchor" href="#multiple-linear-regression-fixed-ivs"></a>
</h2>
<div class="section level4">
<h4 id="example-13-1">Example 13.1<a class="anchor" aria-label="anchor" href="#example-13-1"></a>
</h4>
<p>Evaluating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>.1</mn></mrow><annotation encoding="application/x-tex">R^2=.1</annotation></semantics></math>
generated data for a linear regression model given the null hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msubsup><mi>R</mi><mn>0</mn><mn>2</mn></msubsup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:R^2_0=0</annotation></semantics></math>.
When evaluated using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>95</mn></mrow><annotation encoding="application/x-tex">N=95</annotation></semantics></math>
observations with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">k=5</annotation></semantics></math>
predictor variables gives the estimate.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_lm.R2.html">p_lm.R2</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">95</span>, R2<span class="op">=</span><span class="fl">.1</span>, k<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:31</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n    R2     k sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    95   0.1     5      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.664</span></span>
<span><span class="co">## 95% Confidence Interval: [0.655, 0.674]</span></span></code></pre>
<p>G*power gives
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.673</mn></mrow><annotation encoding="application/x-tex">1-\beta = .673</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="example-14-3">Example 14.3<a class="anchor" aria-label="anchor" href="#example-14-3"></a>
</h4>
<p>Similarly, comparing nested models for changes in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>.
For the following, note that <code>k</code> is total IVs (in this case,
9), while <code>k.R2_0</code> is number of IVs for baseline model (in
this case, 5). At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>.01</mn></mrow><annotation encoding="application/x-tex">\alpha=.01</annotation></semantics></math>
and a change of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>.05</mn></mrow><annotation encoding="application/x-tex">\Delta R^2=.05</annotation></semantics></math>
from the baseline
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mn>0</mn><mn>2</mn></msubsup><mo>=</mo><mn>.25</mn></mrow><annotation encoding="application/x-tex">R^2_0=.25</annotation></semantics></math>
gives</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_lm.R2.html">p_lm.R2</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">90</span>, R2<span class="op">=</span><span class="fl">.3</span>, k<span class="op">=</span><span class="fl">9</span>, R2_0<span class="op">=</span><span class="fl">.25</span>, k.R2_0<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>sig.level<span class="op">=</span><span class="fl">.01</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:39</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">##       n    R2     k  R2_0 k.R2_0 sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    90   0.3     9  0.25      5      0.01 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.238</span></span>
<span><span class="co">## 95% Confidence Interval: [0.230, 0.247]</span></span></code></pre>
<p>G*power gives
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.241</mn></mrow><annotation encoding="application/x-tex">1-\beta = .241</annotation></semantics></math>.
Solving the sample size to achieve 80% power</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_lm.R2.html">p_lm.R2</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">400</span><span class="op">)</span>, R2<span class="op">=</span><span class="fl">.3</span>, R2_0 <span class="op">=</span> <span class="fl">.25</span>, k<span class="op">=</span><span class="fl">9</span>, k.R2_0<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>sig.level<span class="op">=</span><span class="fl">.01</span>, power<span class="op">=</span><span class="fl">.8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:02:15</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">##       n    R2     k  R2_0 k.R2_0 sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.3     9  0.25      5      0.01   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 242.6</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [240.5, 244.6]</span></span></code></pre>
<p>G*power gives
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>242</mn></mrow><annotation encoding="application/x-tex">n = 242</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="example-14-3b">Example 14.3b<a class="anchor" aria-label="anchor" href="#example-14-3b"></a>
</h4>
<p>Nested model comparison for changes in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
for models with 12 IVs versus 9 IVs. Requires the specification of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>i</mi><mi>d</mi><mi>u</mi><mi>a</mi><mi>l</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">R^2_{residual}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_lm.R2.html">p_lm.R2</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">200</span>, R2<span class="op">=</span><span class="fl">.16</span>, R2_0 <span class="op">=</span> <span class="fl">.1</span>, k<span class="op">=</span><span class="fl">12</span>, k.R2_0<span class="op">=</span><span class="fl">9</span>, R2.resid<span class="op">=</span><span class="fl">.8</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>sig.level<span class="op">=</span><span class="fl">.01</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:52</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 8</span></span></span>
<span><span class="co">##       n    R2     k  R2_0 k.R2_0 R2.resid sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   200  0.16    12   0.1      9      0.8      0.01 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.756</span></span>
<span><span class="co">## 95% Confidence Interval: [0.748, 0.765]</span></span></code></pre>
<p>G*power gives
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.767</mn></mrow><annotation encoding="application/x-tex">1-\beta = .767</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="multiple-linear-regression-random-ivs">Multiple Linear Regression (Random IVs)<a class="anchor" aria-label="anchor" href="#multiple-linear-regression-random-ivs"></a>
</h2>
<div class="section level4">
<h4 id="example-7-3">Example 7.3<a class="anchor" aria-label="anchor" href="#example-7-3"></a>
</h4>
<p>Same as in Example 13.1 above, however assuming that the IVs are
randomly sampled instead of fixed.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_lm.R2.html">p_lm.R2</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">95</span>, R2<span class="op">=</span><span class="fl">.1</span>, k<span class="op">=</span><span class="fl">5</span>, fixed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:10</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##       n    R2     k fixed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    95   0.1     5 FALSE      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.659</span></span>
<span><span class="co">## 95% Confidence Interval: [0.650, 0.669]</span></span></code></pre>
<p>G*power gives 0.662 using a one-tailed test criterion.</p>
</div>
</div>
<div class="section level2">
<h2 id="simple-linear-regression">Simple linear regression<a class="anchor" aria-label="anchor" href="#simple-linear-regression"></a>
</h2>
<div class="section level3">
<h3 id="example-12-3">Example 12.3<a class="anchor" aria-label="anchor" href="#example-12-3"></a>
</h3>
<p>Evaluate post-hoc power for simple linear regression model null
hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\beta_1=0</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>x</mi></msub><mo>=</mo><mn>7.5</mn></mrow><annotation encoding="application/x-tex">\sigma_x = 7.5</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>y</mi></msub><annotation encoding="application/x-tex">\sigma_y</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><mn>0.0667</mn></mrow><annotation encoding="application/x-tex">\beta_1=-0.0667</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">N=100</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_slr.html">p_slr</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, beta<span class="op">=</span><span class="op">-</span><span class="fl">0.0667</span>, sd_x<span class="op">=</span><span class="fl">7.5</span>, sd_y <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:21</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n  sd_x  sd_y sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   100   7.5     4      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.243</span></span>
<span><span class="co">## 95% Confidence Interval: [0.234, 0.251]</span></span></code></pre>
<p>G*power returns the power estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>0.2389</mn></mrow><annotation encoding="application/x-tex">1-\beta = 0.2389</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="fixed-effects-anova---one-way-f-test">Fixed effects ANOVA - One way (F-test)<a class="anchor" aria-label="anchor" href="#fixed-effects-anova---one-way-f-test"></a>
</h2>
<div class="section level4">
<h4 id="example-10-3">Example 10.3<a class="anchor" aria-label="anchor" href="#example-10-3"></a>
</h4>
<p>One-way ANOVA example to solve
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
per group (of which there are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">k=10</annotation></semantics></math>),
using Cohen’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><mn>.25</mn></mrow><annotation encoding="application/x-tex">f=.25</annotation></semantics></math>,
to achieve a power of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.95</mn></mrow><annotation encoding="application/x-tex">1-\beta=.95</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_anova.test.html">p_anova.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">300</span><span class="op">)</span>, k<span class="op">=</span><span class="fl">10</span>, f<span class="op">=</span><span class="fl">.25</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.95</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:17</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n     k     f sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>    10  0.25      0.05  0.95</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 38.7</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [38.1, 39.2]</span></span></code></pre>
<p>G*power gives the estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>39</mn></mrow><annotation encoding="application/x-tex">n=39</annotation></semantics></math>.</p>
<p>Fixing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">n=200</annotation></semantics></math>
in total (hence,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>200</mn><mi>/</mi><mi>k</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">n=200/k=20</annotation></semantics></math>)
and performing a compromise analysis assuming
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mfrac><mi>β</mi><mi>α</mi></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">q=\frac{\beta}{\alpha}=1</annotation></semantics></math>,</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_anova.test.html">p_anova.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span>, k<span class="op">=</span><span class="fl">10</span>, f<span class="op">=</span><span class="fl">.25</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>beta_alpha<span class="op">=</span><span class="fl">1</span>, replications<span class="op">=</span><span class="fl">30000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:29</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##       n     k     f sig.level power beta_alpha</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    20    10  0.25        <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>             1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of Type I error rate (alpha/sig.level): 0.160</span></span>
<span><span class="co">## 95% Confidence Interval: [0.156, 0.164]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power (1-beta): 0.840</span></span>
<span><span class="co">## 95% Confidence Interval: [0.836, 0.844]</span></span></code></pre>
<p>G*Power gives
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mi>β</mi><mo>=</mo><mn>0.159</mn></mrow><annotation encoding="application/x-tex">\alpha=\beta=0.159</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="t-test-linear-regression-two-groups">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test:
Linear regression (two groups)<a class="anchor" aria-label="anchor" href="#t-test-linear-regression-two-groups"></a>
</h2>
<p>Test coefficients across distinct datasets with similar form. In this
case</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>1</mn></msub><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">Y_1 = \beta_0 + \beta_1 X_1 + \epsilon</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>2</mn></msub><mo>=</mo><msubsup><mi>β</mi><mn>0</mn><mo>*</mo></msubsup><mo>+</mo><msubsup><mi>β</mi><mn>1</mn><mo>*</mo></msubsup><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">Y_2 = \beta_0^* + \beta_1^* X_2 + \epsilon</annotation></semantics></math></p>
<p>where the null of interest is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><msub><mi>β</mi><mn>1</mn></msub><mo>−</mo><msubsup><mi>β</mi><mn>1</mn><mo>*</mo></msubsup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\, \beta_1 - \beta_1^* = 0</annotation></semantics></math></p>
<p>To do this a multiple linear regression model is setup with three
variables</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mi>X</mi><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mi>S</mi><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo>⋅</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">Y = \beta_0 + \beta_1 X + \beta_2 S + \beta_3 (S\cdot X) + \epsilon</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Y</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">Y=[Y_1, Y_2]</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">X = [X_1, X_2]</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
is a binary indicator variable indicating whether the observations were
in the second sample.</p>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">S = 0</annotation></semantics></math>
the first group’s parameterization will be recovered, while when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">S=1</annotation></semantics></math>
the second group’s parameterization will be recovered as the potentially
non-zero
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\beta_2</annotation></semantics></math>
reflects a change in the intercept
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>β</mi><mn>0</mn><mo>*</mo></msubsup><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\beta_0^* = \beta_0 + \beta_2</annotation></semantics></math>)
while the change in the slope for the second group will be reflected by
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>3</mn></msub><annotation encoding="application/x-tex">\beta_3</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>β</mi><mn>1</mn><mo>*</mo></msubsup><mo>=</mo><msub><mi>β</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1^*=\beta_1 + \beta_3</annotation></semantics></math>).
Hence, the null hypothesis that the two groups have the same slope can
be evaluated using this augmented model by testing</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><msub><mi>β</mi><mn>3</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\, \beta_3 = 0</annotation></semantics></math></p>
<div class="section level4">
<h4 id="example-17-3-and-18-3">Example 17.3 and 18.3<a class="anchor" aria-label="anchor" href="#example-17-3-and-18-3"></a>
</h4>
<p>We start by defining the population generating model to replace the
<code><a href="../../reference/p_glm.html">gen_glm()</a></code> function that is the default in
<code><a href="../../reference/p_glm.html">p_glm()</a></code>. This generating function is organized such that a
<code>data.frame</code> is returned with the columns <code>y</code>,
<code>X</code>, and <code>S</code>, where the interaction effect
reflects the magnitude of the difference between the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
coefficients across the independent samples.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gen_twogroup</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">dbeta</span>, <span class="va">sdx1</span>, <span class="va">sdx2</span>, <span class="va">sigma</span>, <span class="va">n2_n1</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd<span class="op">=</span><span class="va">sdx1</span><span class="op">)</span></span>
<span>    <span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">n2_n1</span>, sd<span class="op">=</span><span class="va">sdx2</span><span class="op">)</span></span>
<span>    <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span><span class="op">)</span></span>
<span>    <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span>    <span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">N</span><span class="op">-</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">dbeta</span> <span class="op">*</span> <span class="va">X</span><span class="op">*</span><span class="va">S</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, sd<span class="op">=</span><span class="va">sigma</span><span class="op">)</span></span>
<span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, <span class="va">S</span><span class="op">)</span></span>
<span>    <span class="va">dat</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To demonstrate, the post-hoc power for the described example in
G*Power is the following.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_glm.html">p_glm</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">y</span><span class="op">~</span><span class="va">X</span><span class="op">*</span><span class="va">S</span>, test<span class="op">=</span><span class="st">"X:S = 0"</span>,</span>
<span>      n<span class="op">=</span><span class="fl">28</span>, n2_n1<span class="op">=</span><span class="fl">44</span><span class="op">/</span><span class="fl">28</span>, sdx1<span class="op">=</span><span class="fl">9.02914</span>, sdx2<span class="op">=</span><span class="fl">11.86779</span>, dbeta<span class="op">=</span><span class="fl">0.01592</span>,</span>
<span>      sigma<span class="op">=</span><span class="fl">0.5578413</span>, gen_fun<span class="op">=</span><span class="va">gen_twogroup</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:24</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 8</span></span></span>
<span><span class="co">##   test      sigma     n   sdx1   sdx2   dbeta sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> X:S = 0 0.557<span style="text-decoration: underline;">84</span>    28 9.029<span style="text-decoration: underline;">1</span> 11.868 0.015<span style="text-decoration: underline;">92</span>      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.199</span></span>
<span><span class="co">## 95% Confidence Interval: [0.191, 0.207]</span></span></code></pre>
<p>For the a priori power analysis to achieve a power of .80</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_glm.html">p_glm</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">y</span><span class="op">~</span><span class="va">X</span><span class="op">*</span><span class="va">S</span>, test<span class="op">=</span><span class="st">"X:S = 0"</span>,</span>
<span>      n<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span>, n2_n1<span class="op">=</span><span class="fl">44</span><span class="op">/</span><span class="fl">28</span>, sdx1<span class="op">=</span><span class="fl">9.02914</span>, sdx2<span class="op">=</span><span class="fl">11.86779</span>, dbeta<span class="op">=</span><span class="fl">0.01592</span>,</span>
<span>      sigma<span class="op">=</span><span class="fl">0.5578413</span>, gen_fun<span class="op">=</span><span class="va">gen_twogroup</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:01:25</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 8</span></span></span>
<span><span class="co">##   test      sigma     n   sdx1   sdx2   dbeta sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> X:S = 0 0.557<span style="text-decoration: underline;">84</span>    <span style="color: #BB0000;">NA</span> 9.029<span style="text-decoration: underline;">1</span> 11.868 0.015<span style="text-decoration: underline;">92</span>      0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 164.9</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [163.3, 166.8]</span></span></code></pre>
<p>G*Power gives the estimate for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
to be 163 (and therefore 256 in the second group given the
<code>n2_n1</code>).</p>
</div>
</div>
<div class="section level2">
<h2 id="variance-tests">Variance tests<a class="anchor" aria-label="anchor" href="#variance-tests"></a>
</h2>
<div class="section level4">
<h4 id="example-26-3-difference-from-constant-one-sample-case">Example 26.3; Difference from constant (one sample case)<a class="anchor" aria-label="anchor" href="#example-26-3-difference-from-constant-one-sample-case"></a>
</h4>
<p>Solve
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
for variance ratio of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mn>1.5</mn><mo>=</mo><mn>2</mn><mi>/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">1/1.5 = 2/3</annotation></semantics></math>
using a one-tailed variance ratio test, assuming that the target power
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.80</mn></mrow><annotation encoding="application/x-tex">1-\beta=.80</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_var.test.html">p_var.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">200</span><span class="op">)</span>, vars<span class="op">=</span><span class="fl">1</span>, sigma2<span class="op">=</span><span class="fl">1.5</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.80</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:24</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##       n  vars sigma2 two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>     1    1.5 FALSE           0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 80.6</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [79.3, 82.2]</span></span></code></pre>
<p>G*power gives sample size of 81.</p>
</div>
<div class="section level3">
<h3 id="example-15-3-two-sample-variance-test">Example 15.3; Two-sample variance test<a class="anchor" aria-label="anchor" href="#example-15-3-two-sample-variance-test"></a>
</h3>
<p>For a two-sample equality of variance test with equal sample
sizes,</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># solve n for variance ratio of 1/1.5 = 2/3, two.tailed, 80% power</span></span>
<span><span class="fu"><a href="../../reference/p_var.test.html">p_var.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">300</span><span class="op">)</span>, vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>, two.tailed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.80</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:32</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span> TRUE            0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 193.4</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [191.5, 195.4]</span></span></code></pre>
<p>G*Power gives estimate of 193 per group.</p>
</div>
</div>
<div class="section level2">
<h2 id="t-tests">t-tests<a class="anchor" aria-label="anchor" href="#t-tests"></a>
</h2>
<p>Estimate sample size
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>)
per group in independent samples
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test,
one-tailed, medium effect size
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">d=0.5</annotation></semantics></math>),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha=0.05</annotation></semantics></math>,
95% power
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>0.95</mn></mrow><annotation encoding="application/x-tex">1-\beta = 0.95</annotation></semantics></math>),
equal sample sizes
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>n</mi><mn>2</mn></msub><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{n_2}{n_1}=1</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">500</span><span class="op">)</span>, d <span class="op">=</span> <span class="fl">.5</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>               <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:09</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n     d two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.5 FALSE           0.05  0.95</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 86.9</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [85.2, 88.5]</span></span></code></pre>
<p>G*power estimate is 88 per group, <code>Spower</code> estimate is
86.9348 with the 95% CI [85.2011, 88.4739].</p>
<div class="section level4">
<h4 id="example-19-3-paired-samples-t-test">Example 19.3; Paired samples t-test<a class="anchor" aria-label="anchor" href="#example-19-3-paired-samples-t-test"></a>
</h4>
<p>Paired-samples
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test,
assuming the generated difference is the repeated measures Cohen’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>r</mi></msub><mo>=</mo><mn>.421637</mn></mrow><annotation encoding="application/x-tex">d_r=.421637</annotation></semantics></math>
(e.g., were the unadjusted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>.4</mn></mrow><annotation encoding="application/x-tex">d=.4</annotation></semantics></math>,
while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo>=</mo><mn>.55</mn></mrow><annotation encoding="application/x-tex">r_{xy} = .55</annotation></semantics></math>,
then this results in the repeated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>r</mi></msub><mo>=</mo><mfrac><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>μ</mi><mi>x</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><msqrt><mrow><msubsup><mi>σ</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi>y</mi><mn>2</mn></msubsup><mo>−</mo><mn>2</mn><msub><mi>ρ</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub><msub><mi>σ</mi><mi>x</mi></msub><msub><mi>σ</mi><mi>y</mi></msub></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">d_r=\frac{|\mu_x-\mu_y|}{\sqrt{\sigma^2_x + \sigma^2_y - 2\rho_{xy}\sigma_x\sigma_y}}</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span> <span class="op">*</span> <span class="fl">2</span>, d<span class="op">=</span><span class="fl">0.421637</span>, type <span class="op">=</span> <span class="st">'paired'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>replications<span class="op">=</span><span class="fl">50000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:13</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##         d type   sig.level power</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 0.421<span style="text-decoration: underline;">64</span> paired      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.840</span></span>
<span><span class="co">## 95% Confidence Interval: [0.837, 0.843]</span></span></code></pre>
<p>G*power gives power estimate of .832, though Cohen reported a value
closer to .840. When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>0.2828427</mn></mrow><annotation encoding="application/x-tex">d=0.2828427</annotation></semantics></math>
this leads to</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span> <span class="op">*</span> <span class="fl">2</span>, d<span class="op">=</span><span class="fl">.2828427</span>, type <span class="op">=</span> <span class="st">'paired'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>replications<span class="op">=</span><span class="fl">50000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:12</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##         d type   sig.level power</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 0.282<span style="text-decoration: underline;">84</span> paired      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.508</span></span>
<span><span class="co">## 95% Confidence Interval: [0.503, 0.512]</span></span></code></pre>
<p>In this case G*Power 3.1 gives the estimate .500. To answer the
question “How many subjects would we need to arrive at a power of about
0.832114 in a two-group design?” this is specified within
<code><a href="../../reference/Spower.html">Spower()</a></code> and where <code>n</code> is set to <code>NA</code>
and <code><a href="../../reference/Spower.html">Spower()</a></code> is passed an <code>interval</code> argument,
or <code><a href="../../reference/Spower.html">interval()</a></code> is passed directly to the <code>n</code>
element in the experiment.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">300</span><span class="op">)</span>, d<span class="op">=</span><span class="fl">0.2828427</span>, type <span class="op">=</span> <span class="st">'paired'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">0.832114</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:16</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n       d type   sig.level   power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span> 0.282<span style="text-decoration: underline;">84</span> paired      0.05 0.832<span style="text-decoration: underline;">11</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 215.9</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [213.7, 218.1]</span></span></code></pre>
<p>G*power reports that around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>110</mn><mo>*</mo><mn>2</mn><mo>=</mo><mn>220</mn></mrow><annotation encoding="application/x-tex">N=110*2=220</annotation></semantics></math>
pairs are required, though this is estimated visually using
interpolation.</p>
</div>
<div class="section level4">
<h4 id="example-20-3-one-sample-t-test">Example 20.3; One-sample t-test<a class="anchor" aria-label="anchor" href="#example-20-3-one-sample-t-test"></a>
</h4>
<p>Evaluating the hypotheses for the mean expression
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>μ</mi><mo>≤</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0:\mu\le\mu_0</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>a</mi></msub><mo>:</mo><mi>μ</mi><mo>&gt;</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_a:\mu&gt;\mu_0</annotation></semantics></math></p>
<p>using a one-sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test.
The following estimates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
given a one-tailed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>.625</mn></mrow><annotation encoding="application/x-tex">d=.625</annotation></semantics></math>
to achieve
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.95</mn></mrow><annotation encoding="application/x-tex">1-\beta=.95</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span>, d<span class="op">=</span><span class="fl">.625</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span>, type<span class="op">=</span><span class="st">'one.sample'</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.95</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:07</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##       n     d type       two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span> 0.625 one.sample FALSE           0.05  0.95</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 28.7</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [28.0, 29.4]</span></span></code></pre>
<p>G*power gives sample size of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>30</mn></mrow><annotation encoding="application/x-tex">n=30</annotation></semantics></math>.
Similarly, though with different inputs.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">2000</span><span class="op">)</span>, d<span class="op">=</span><span class="fl">.1</span>, type<span class="op">=</span><span class="st">'one.sample'</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.9</span>,sig.level<span class="op">=</span><span class="fl">.01</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:11</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n     d type       sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.1 one.sample      0.01   0.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 1509.8</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [1489.5, 1529.2]</span></span></code></pre>
<p>G*power gives sample size of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>1492</mn></mrow><annotation encoding="application/x-tex">n=1492</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="wilcoxon-tests">Wilcoxon tests<a class="anchor" aria-label="anchor" href="#wilcoxon-tests"></a>
</h3>
<div class="section level4">
<h4 id="example-22-3-one-sample-test-with-normal-distribution">Example 22.3; One-sample test with normal distribution<a class="anchor" aria-label="anchor" href="#example-22-3-one-sample-test-with-normal-distribution"></a>
</h4>
<p>Same as Example 22.1 above.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_wilcox.test.html">p_wilcox.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">649</span>, d<span class="op">=</span><span class="fl">.1</span>, type<span class="op">=</span><span class="st">'one.sample'</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:12</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##       n     d type       two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   649   0.1 one.sample FALSE           0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.799</span></span>
<span><span class="co">## 95% Confidence Interval: [0.791, 0.806]</span></span></code></pre>
<p>G*power 3.1 provides a power estimate of .800, agreeing with
<code>Spower</code>.</p>
<p>Similarly, assuming that the distribution for the one-sample followed
a Laplace distribution, and that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>11</mn></mrow><annotation encoding="application/x-tex">N=11</annotation></semantics></math>
were used instead. This requires defining an alternative parent
distribution, which below uses the <code>rlaplace</code> function from
the <code>extraDistr</code> package.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sigbertklinke/extraDistr" class="external-link">extraDistr</a></span><span class="op">)</span></span>
<span><span class="va">parent1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">d</span><span class="op">)</span> <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Laplace.html" class="external-link">rlaplace</a></span><span class="op">(</span><span class="va">n</span>, mu<span class="op">=</span><span class="va">d</span>, sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># properties of sampled distribution</span></span>
<span><span class="fu"><a href="http://philchalmers.github.io/SimDesign/reference/descript.html" class="external-link">descript</a></span><span class="op">(</span><span class="fu">parent1</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100000</span>, d<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 14</span></span></span>
<span><span class="co">##   VARS       n  miss  mean trimmed    sd   mad skewness kurtosis   min  Q_25</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> df    <span style="text-decoration: underline;">100</span>000    <span style="color: #BB0000;">NA</span> 0.800   0.799 0.999 0.727  0.007<span style="text-decoration: underline;">02</span>     3.06 -<span style="color: #BB0000;">7.94</span> 0.309</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: Q_50 &lt;dbl&gt;, Q_75 &lt;dbl&gt;, max &lt;dbl&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_wilcox.test.html">p_wilcox.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">11</span>, d<span class="op">=</span><span class="fl">.8</span>, type<span class="op">=</span><span class="st">'one.sample'</span>, two.tailed<span class="op">=</span><span class="cn">FALSE</span>, parent1 <span class="op">=</span> <span class="va">parent1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:02</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##       n     d type       two.tailed sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    11   0.8 one.sample FALSE           0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.815</span></span>
<span><span class="co">## 95% Confidence Interval: [0.807, 0.822]</span></span></code></pre>
<p>Interestingly, G*power 3.1 reports this power to be 0.830.</p>
</div>
<div class="section level4">
<h4 id="two-sample-test-with-laplace-distributions">Two-sample test with Laplace distributions<a class="anchor" aria-label="anchor" href="#two-sample-test-with-laplace-distributions"></a>
</h4>
<p>Two-sample Wilcoxon test comparing Laplace distributions with
different central tendencies.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sigbertklinke/extraDistr" class="external-link">extraDistr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">parent1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">d</span><span class="op">)</span> <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Laplace.html" class="external-link">rlaplace</a></span><span class="op">(</span><span class="va">n</span>, mu<span class="op">=</span><span class="va">d</span>, sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">parent2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">d</span><span class="op">)</span> <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Laplace.html" class="external-link">rlaplace</a></span><span class="op">(</span><span class="va">n</span>, sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># properties of sampled distributions</span></span>
<span><span class="fu"><a href="http://philchalmers.github.io/SimDesign/reference/descript.html" class="external-link">descript</a></span><span class="op">(</span><span class="fu">parent1</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100000</span>, d<span class="op">=</span><span class="fl">0.375</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 14</span></span></span>
<span><span class="co">##   VARS       n  miss  mean trimmed    sd   mad skewness kurtosis   min   Q_25</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> df    <span style="text-decoration: underline;">100</span>000    <span style="color: #BB0000;">NA</span> 0.381   0.382 0.997 0.725   0.025<span style="text-decoration: underline;">6</span>     3.02 -<span style="color: #BB0000;">6.07</span> -<span style="color: #BB0000;">0.107</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: Q_50 &lt;dbl&gt;, Q_75 &lt;dbl&gt;, max &lt;dbl&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://philchalmers.github.io/SimDesign/reference/descript.html" class="external-link">descript</a></span><span class="op">(</span><span class="fu">parent1</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100000</span>, d<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 14</span></span></span>
<span><span class="co">##   VARS       n  miss    mean trimmed    sd   mad skewness kurtosis   min   Q_25</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> df    <span style="text-decoration: underline;">100</span>000    <span style="color: #BB0000;">NA</span> 0.002<span style="text-decoration: underline;">67</span> 0.002<span style="text-decoration: underline;">72</span> 1.000 0.726  0.004<span style="text-decoration: underline;">90</span>     2.86 -<span style="color: #BB0000;">8.77</span> -<span style="color: #BB0000;">0.485</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: Q_50 &lt;dbl&gt;, Q_75 &lt;dbl&gt;, max &lt;dbl&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nr</span> <span class="op">&lt;-</span> <span class="fl">134</span><span class="op">/</span><span class="fl">67</span></span>
<span><span class="fu"><a href="../../reference/p_wilcox.test.html">p_wilcox.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">67</span>, n2_n1<span class="op">=</span><span class="va">nr</span>, d<span class="op">=</span><span class="fl">0.375</span>, parent1<span class="op">=</span><span class="va">parent1</span>, parent2<span class="op">=</span><span class="va">parent2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:06</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n     d sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    67 0.375      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.851</span></span>
<span><span class="co">## 95% Confidence Interval: [0.844, 0.858]</span></span></code></pre>
<p>Unlike before with the Laplace distribution, G*power 3.1 seems to
agree with <code>Spower</code>, where a power of .847 is reported. This
seems to raise questions about the consistency of the results.</p>
</div>
<div class="section level4">
<h4 id="example-23-3-paired-samples-test-with-laplace-distributions">Example 23.3: Paired-samples test with Laplace distributions<a class="anchor" aria-label="anchor" href="#example-23-3-paired-samples-test-with-laplace-distributions"></a>
</h4>
<p>Finally, paired-samples approach using Wilcoxon test with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">N=10</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parent1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">d</span><span class="op">)</span> <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Laplace.html" class="external-link">rlaplace</a></span><span class="op">(</span><span class="va">n</span>, mu<span class="op">=</span><span class="va">d</span>, sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">parent2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">d</span><span class="op">)</span> <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Laplace.html" class="external-link">rlaplace</a></span><span class="op">(</span><span class="va">n</span>, sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="http://philchalmers.github.io/SimDesign/reference/descript.html" class="external-link">descript</a></span><span class="op">(</span><span class="fu">parent1</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100000</span>, d<span class="op">=</span><span class="fl">1.13842</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 14</span></span></span>
<span><span class="co">##   VARS       n  miss  mean trimmed    sd   mad skewness kurtosis   min  Q_25</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> df    <span style="text-decoration: underline;">100</span>000    <span style="color: #BB0000;">NA</span>  1.14    1.14 0.996 0.727   0.015<span style="text-decoration: underline;">8</span>     2.93 -<span style="color: #BB0000;">7.46</span> 0.653</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: Q_50 &lt;dbl&gt;, Q_75 &lt;dbl&gt;, max &lt;dbl&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://philchalmers.github.io/SimDesign/reference/descript.html" class="external-link">descript</a></span><span class="op">(</span><span class="fu">parent1</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100000</span>, d<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 14</span></span></span>
<span><span class="co">##   VARS      n  miss     mean  trimmed    sd   mad skewness kurtosis   min   Q_25</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> df      1<span style="color: #949494;">e</span>5    <span style="color: #BB0000;">NA</span> -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">05</span> -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">84</span>  1.00 0.722   0.014<span style="text-decoration: underline;">7</span>     3.16 -<span style="color: #BB0000;">7.60</span> -<span style="color: #BB0000;">0.490</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: Q_50 &lt;dbl&gt;, Q_75 &lt;dbl&gt;, max &lt;dbl&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/p_wilcox.test.html">p_wilcox.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span><span class="op">*</span><span class="fl">2</span>, d<span class="op">=</span><span class="fl">1.13842</span>, type <span class="op">=</span> <span class="st">'paired'</span>,</span>
<span>              parent1<span class="op">=</span><span class="va">parent1</span>, parent2<span class="op">=</span><span class="va">parent2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:02</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##        d type   sig.level power</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1.138<span style="text-decoration: underline;">4</span> paired      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.933</span></span>
<span><span class="co">## 95% Confidence Interval: [0.928, 0.938]</span></span></code></pre>
<p>Again, the simulation approach and G*power 3.1 differ in their
outputs, where in G*power 3.1 the reported power is 0.853.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
