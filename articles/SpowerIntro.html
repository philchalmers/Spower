<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to the Spower package • Spower</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the Spower package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Spower</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/gpower_examples.html">G*Power examples evaluated with Spower</a></li>
    <li><a class="dropdown-item" href="../articles/original/gpower_examples.html">G*Power examples evaluated with Spower</a></li>
    <li><a class="dropdown-item" href="../articles/Spower_TypeSM.html">Type M and Type S errors</a></li>
    <li><a class="dropdown-item" href="../articles/SpowerIntro_logicals.html">Logical Vectors, Bayesian power analyses, and ROPEs</a></li>
    <li><a class="dropdown-item" href="../articles/SpowerIntro.html">Introduction to the Spower package</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/Spower/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to the Spower package</h1>
                        <h4 data-toc-skip class="author">Phil
Chalmers</h4>
            
            <h4 data-toc-skip class="date">February 11, 2026</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/Spower/blob/main/vignettes/SpowerIntro.Rmd" class="external-link"><code>vignettes/SpowerIntro.Rmd</code></a></small>
      <div class="d-none name"><code>SpowerIntro.Rmd</code></div>
    </div>

    
    
<p>This vignette provides a brief introduction to using the package
<code>Spower</code> for prospective/post-hoc, a priori, sensitivity,
criterion, and compromise power analyses. For a more detailed
description of the package structure and philosophy please refer to
associated publication (Chalmers, 2025), as well as the documentation
found within the functions; particularly, <code><a href="../reference/Spower.html">Spower()</a></code>,
<code><a href="../reference/Spower.html">SpowerBatch()</a></code>, and <code><a href="../reference/Spower.html">SpowerCurve()</a></code>.</p>
<div class="section level2">
<h2 id="types-of-functions">Types of functions<a class="anchor" aria-label="anchor" href="#types-of-functions"></a>
</h2>
<p>There are generally two ways to go about using <code>Spower</code>.
The first is by utilizing one of a handful of <strong>build-in
simulation experiments</strong> with an associated data-generation and
analysis, or more flexibility (but less user friendly) by constructing a
<strong>user-defined simulation experiment</strong> by way of writing
simulation code that is encapsulated inside a single function. In either
case, the goal is to design R code to perform a given simulation
experiment with a set of meaningful (often scalar) functional arguments,
where the output from this function returns either:</p>
<ol style="list-style-type: decimal">
<li>A suitable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
under the null hypothesis statistical testing (NHST) paradigm,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(D|H_0)</annotation></semantics></math>,</li>
<li>The posterior probability of a (typically alternative) hypothesis,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(H_1|D)</annotation></semantics></math>,
or</li>
<li>A logical value indicating support for the hypothesis of
interest</li>
</ol>
<p>For the first two cases, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
value returned is compared to a suitable cut-off defined by the package
(e.g., is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
less than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>.05</mn></mrow><annotation encoding="application/x-tex">\alpha=.05</annotation></semantics></math>
for the first option, while the second might be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
greater than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mn>.95</mn></mrow><annotation encoding="application/x-tex">\alpha.95</annotation></semantics></math>),
and therefore converted to a <code>TRUE/FALSE</code> value internally,
while the ladder does not require such a transformation. In all cases,
the average of the resulting <code>TRUE</code>/<code>FALSE</code> values
reflects something to do with statistical power (e.g., <code>TRUE</code>
if rejecting the null; <code>TRUE</code> if supporting the alternative;
some more complicated combination involving precision, multiple
hypotheses, regions of practical equivalence/significance, etc), thereby
forming the basis for all subsequent power analysis procedures.</p>
<p>The internal functions available in <code>Spower</code> primarily
focuses on the first approach criteria involving NHST
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values,
as this is historically the most common in similar software (e.g.,
<em>GPower 3</em>), however nothing precludes <code>Spower</code> from
more complex and interesting power analyses. See the vignette
<em>“Logical Vectors, Bayesian power analyses and ROPEs”</em> for more
advanced examples involving confidence intervals (CIs), parameter
precision criterion, regions of practical equivalences (ROPEs),
equivalence tests, Bayes Factors, and power analyses involving posterior
probabilities. See also the vignette <em>“Type S and Type M errors”</em>
for conditional power evaluation information to estimate sign (S) and
magnitude (M) power information and their respective Type S and Type M
errors (Gelman and Carlin, 2014).</p>
<div class="section level3">
<h3 id="built-in-simulation-experiments">Built-in simulation experiments<a class="anchor" aria-label="anchor" href="#built-in-simulation-experiments"></a>
</h3>
<p><code>Spower</code> ships with several common statistical inference
experiments, such as those involving linear regression models, mediation
analyses, ANOVAs,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-tests,
correlations, and so on. The simulation experiments are organized with
the prefix <code>p_</code>, followed by the name of the analysis method.
For instance,</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p_lm.R2.html">p_lm.R2</a></span><span class="op">(</span><span class="fl">50</span>, k<span class="op">=</span><span class="fl">3</span>, R2<span class="op">=</span><span class="fl">.3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.004935905</span></span></code></pre>
<p>performs a single simulation experiment reflecting the null
hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\, R^2=0</annotation></semantics></math>
for a linear regression model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">k=3</annotation></semantics></math>
predictor variables and a sample size of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">N=50</annotation></semantics></math>.</p>
<p>Translating this information into a power analysis context now simply
requires passing this experiment to <code><a href="../reference/Spower.html">Spower()</a></code> (the details
of which are discussed below), where by default the estimate of power
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mover><mi>β</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">1-\hat{\beta}</annotation></semantics></math>)
is returned using the default <code>sig.level = .05</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p_lm.R2.html">p_lm.R2</a></span><span class="op">(</span><span class="fl">50</span>, k<span class="op">=</span><span class="fl">3</span>, R2<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:41</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n    R2     k sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    50   0.3     3      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.971</span></span>
<span><span class="co">## 95% Confidence Interval: [0.968, 0.974]</span></span></code></pre>
<p>Each of the <code>p_*</code> functions return a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false" form="prefix">(</mo><mi>D</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P(D|H_0</annotation></semantics></math>)
as this is the general information required to evaluate statistical
power with <code><a href="../reference/Spower.html">Spower()</a></code>. Alternatively, users may define their
own simulation functions if the desired experiment has not been defined
within the package.</p>
</div>
<div class="section level3">
<h3 id="user-defined-simulation-experiments">User-defined simulation experiments<a class="anchor" aria-label="anchor" href="#user-defined-simulation-experiments"></a>
</h3>
<p>As a very simple example, suppose one were interested in the power to
reject the null hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0:\, \mu = \mu_0</annotation></semantics></math>
in a one-sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test
scenario, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(D|H_0)</annotation></semantics></math>
is the probability of the data given the null hypothesis of interest.
Note that while the package already supports this type of analysis (see
<code><a href="../reference/p_t.test.html">help(p_t.test)</a></code>) it is instructive to see how users they can
write their own version of this experiment, as this will help in
defining simulations outside what is currently included in the
package.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_single.t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">mu</span><span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">g</span>, mu<span class="op">=</span><span class="va">mu</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>    <span class="va">p</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This simulation experiment will first obtain sample of data drawn
from a Gaussian distribution with some specific <code>mean</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>),
and evaluate the conditional probability that the data were generated
from a population with a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu_0=0</annotation></semantics></math>
(the null; hence,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>μ</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(D|\mu_0=0)</annotation></semantics></math>).
As such, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
returned from this experiments reflects the probability of observing the
data given the null hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0:\, \mu=\mu_0</annotation></semantics></math>,
or more specifically
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><mi>μ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\, \mu=0</annotation></semantics></math>,
for a single generated dataset.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a single experiment</span></span>
<span><span class="fu">p_single.t</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">.2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.06328707</span></span></code></pre>
<p>From here, a suitable cut-off is required to evaluate whether the
experiment was ‘significant’, which is the purpose of the parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.
Specifically, if the observed data
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>)
were plausibly drawn from a population with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\mu_0</annotation></semantics></math>
(hence,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>μ</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>≥</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">P(D|\mu_0) \ge \alpha</annotation></semantics></math>)
then a <code>FALSE</code> significance would be returned; otherwise, if
the data were unlikely to have been observed given the
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>μ</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">P(D|\mu_0=0) &lt; \alpha</annotation></semantics></math>)
then a <code>TRUE</code> would be returned, thereby indicating
statistical significance.</p>
<p>For convenience, and for the purpose of other types of specialized
power analyses (e.g., compromise analyses), the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
parameter has been controlled via the argument
<code>Spower(..., sig.level = .05)</code>, which creates the
<code>TRUE/FALSE</code> evaluations internally. This saves a step in the
writing, but if users wished to defined <code>sig.level</code> within
the simulation experiment itself that is an acceptable approach too.</p>
</div>
</div>
<div class="section level2">
<h2 id="types-of-power-analyses-to-evaluate">Types of power analyses to evaluate<a class="anchor" aria-label="anchor" href="#types-of-power-analyses-to-evaluate"></a>
</h2>
<p>For power analyses there are typically four parameters that can be
manipulated/solved in a given experiment: the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
level (Type I error, often reflexively set to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>.05</mn></mrow><annotation encoding="application/x-tex">\alpha=.05</annotation></semantics></math>),
power (the complement of the Type II error,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">1-\beta</annotation></semantics></math>),
an effect size of interest, and the sample size. Given three of these
values, the fourth can always be solved.</p>
<p>Note that the above description reflects a general rule-of-thumb, as
there may be multiple effect sizes of interest, multiple sample size
definitions (e.g., in the form of cluster sizes in multi-level models),
and so on. Regardless, in <code><a href="../reference/Spower.html">Spower()</a></code> switching between these
types of power analysis criteria is performed simply by explicitly
specifying which parameter is missing (<code>NA</code>), as demonstrated
below, and therefore specific naming conventions for the type of
analysis being performed is not particularly important, though the
following presentation may be instructive nonetheless.</p>
<div class="section level3">
<h3 id="prospectivepost-hoc-power-analysis">Prospective/post-hoc power analysis<a class="anchor" aria-label="anchor" href="#prospectivepost-hoc-power-analysis"></a>
</h3>
<p>The canonical setup for <code><a href="../reference/Spower.html">Spower()</a></code> will evaluate
prospective or post-hoc power, thereby obtaining the estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mover><mi>β</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">1-\hat{\beta}</annotation></semantics></math>.
By default, <code><a href="../reference/Spower.html">Spower()</a></code> uses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">10,000</annotation></semantics></math>
independent simulation <code>replications</code> to estimate the power
when this is the target criterion.</p>
<p>Given the above simulation definition, the following provides an
estimate of power given the null hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><mi>μ</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">H_0:\, \mu=0.3</annotation></semantics></math>
given that the data were generated from a distribution with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>.5</mn></mrow><annotation encoding="application/x-tex">\mu = .5</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">n=100</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">p_single.t</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">.5</span>, mu<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">prospective</span></span>
<span><span class="va">prospective</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:03</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n  mean    mu sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   100   0.5   0.3      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.515</span></span>
<span><span class="co">## 95% Confidence Interval: [0.505, 0.525]</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="compromise-power-analysis">Compromise power analysis<a class="anchor" aria-label="anchor" href="#compromise-power-analysis"></a>
</h3>
<p>Compromise power analysis involves manipulating the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
level until some sufficient balance between the Type I and Type II error
rates are met, expressed in terms of the ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mfrac><mi>β</mi><mi>α</mi></mfrac></mrow><annotation encoding="application/x-tex">q=\frac{\beta}{\alpha}</annotation></semantics></math>.</p>
<p>In <code>Spower</code>, there are two ways to approach this
criterion. The first, which focuses on the <code>beta_alpha</code> ratio
at the outset, requires passing the target ratio to
<code><a href="../reference/Spower.html">Spower()</a></code> using the same setup as the previous prospective
power analysis.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">p_single.t</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">.5</span>, mu<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>beta_alpha<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">compromise</span></span>
<span><span class="va">compromise</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:03</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##       n  mean    mu sig.level power beta_alpha</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   100   0.5   0.3        <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>             4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of Type I error rate (alpha/sig.level): 0.093</span></span>
<span><span class="co">## 95% Confidence Interval: [0.087, 0.098]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power (1-beta): 0.629</span></span>
<span><span class="co">## 95% Confidence Interval: [0.620, 0.638]</span></span></code></pre>
<p>This returns the estimated <code>sig.level</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>α</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\alpha}</annotation></semantics></math>)
and resulting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>β</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\beta}</annotation></semantics></math>
that satisfies the target
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mi>β</mi><mi>/</mi><mi>α</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">q = \beta/\alpha = 4</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># satisfies q = 4 ratio</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">compromise</span>, <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">power</span><span class="op">)</span> <span class="op">/</span> <span class="va">sig.level</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4</span></span></code></pre>
<p>The second way to perform a compromise analysis is to re-use a
previous evaluation of a prospective/post-hoc power analysis, as this
contains all the necessary information for obtaining the compromise
estimates.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using previous post-hoc/prospective power analysis</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">prospective</span>, beta_alpha<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:03</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##       n  mean    mu sig.level power beta_alpha</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   100   0.5   0.3        <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>             4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of Type I error rate (alpha/sig.level): 0.093</span></span>
<span><span class="co">## 95% Confidence Interval: [0.088, 0.099]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power (1-beta): 0.627</span></span>
<span><span class="co">## 95% Confidence Interval: [0.617, 0.636]</span></span></code></pre>
<p>In either case, the use of S3 generic <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> function
can be beneficial as the stored result may be reused with alternative
<code>beta_alpha</code> values, thereby avoiding the need to estimate
new experimental data.</p>
</div>
<div class="section level3">
<h3 id="a-priori-power-analysis">A priori power analysis<a class="anchor" aria-label="anchor" href="#a-priori-power-analysis"></a>
</h3>
<p>The goal of a priori power analysis is generally to obtain the sample
size
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>)
associated with a specific power rate of interest (e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.90</mn></mrow><annotation encoding="application/x-tex">1-\beta=.90</annotation></semantics></math>),
which is useful in the context of future data collection planning.</p>
<p>To estimate the sample size using Monte Carlo simulation experiments,
<code><a href="../reference/Spower.html">Spower()</a></code> performs stochastic root solving using the
ProBABLI approach from the <code>SimDesign</code> package (see
<code><a href="http://philchalmers.github.io/SimDesign/reference/SimSolve.html" class="external-link">SimSolve()</a></code>), and therefore requires a specific search
<code>interval</code> to search within. The width of the interval should
reflect a plausible range where the researcher believes the solution to
lie, however this may be quite large as well as ProBABLI is less
influenced by the range of the search interval (Chalmers, 2024).
Moreover, as the algorithm is fundamentally based on bisections, the
<em>midpoint</em> of the specified <code>interval</code> should be
organized to reflect the researcher’s “best guess” of where the solution
is likely to be, though this is generally only worth considering if the
simulation experiment under evaluation is very time consuming.</p>
<p>Below the sample size <code>n</code> is solved to achieve a target
power of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.80</mn></mrow><annotation encoding="application/x-tex">1-\beta=.80</annotation></semantics></math>,
where the solution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
was suspected to lie somewhere between the search
<code>interval = c(20, 200)</code>, with the initial starting guess of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>N</mi><mo accent="true">̂</mo></mover><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>20</mn><mo>+</mo><mn>200</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn><mo>=</mo><mn>110</mn></mrow><annotation encoding="application/x-tex">\hat{N}=(20 + 200)/2=110</annotation></semantics></math>
(quite far from the true solution, but in this case adds little to the
overall computation time).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">p_single.t</span><span class="op">(</span>n<span class="op">=</span><span class="cn">NA</span>, mean<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.8</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:25</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.5      0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 32.8</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [32.4, 33.1]</span></span></code></pre>
<p>Equivalently, rather than placing the <code>interval</code>
definition within <code><a href="../reference/Spower.html">Spower()</a></code> and providing a suitable
<code>NA</code> placeholder to indicate which argument
<code>interval</code> pertains to, the function <code><a href="../reference/Spower.html">interval()</a></code>
can be used directly in the experiment definition argument. Hence, the
following will be identical to the above example, though requires less
back-and-forth reading between the pipe seperator.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">p_single.t</span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">200</span><span class="op">)</span>, mean<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:25</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.5      0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 32.8</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [32.4, 33.1]</span></span></code></pre>
<p>Of course, the output will still be presented in terms of the
<code>NA</code> placeholder logic, however in this case the user does
not need to specify the <code>NA</code> explicitly as it is clear from
context.</p>
</div>
<div class="section level3">
<h3 id="sensitivity-power-analysis">Sensitivity power analysis<a class="anchor" aria-label="anchor" href="#sensitivity-power-analysis"></a>
</h3>
<p>Similar to a priori power analysis, in that stochastic root solving
is required, the target of sensitivity analysis is to locate some
specific standardized or unstandardized effect size that will result in
a particular power rate. This pertains to the question of how large an
effect size must be in order to reliably detect the effect of interest,
holding constant other information such as sample size.</p>
<p>Below the sample size is fixed at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">N=100</annotation></semantics></math>,
while the interval for the standardized effect size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
is searched between <code>c(.1, 3)</code>. Note that the use of decimals
in the interval tells <code><a href="../reference/Spower.html">Spower()</a></code> to use a continuous rather
than discrete search space (cf. with a priori, which uses an integer
search space for the simulation replicates).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">p_single.t</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.8</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:20</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   100    <span style="color: #BB0000;">NA</span>      0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of mean: 0.281</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [0.280, 0.283]</span></span></code></pre>
<p>Equivalently, using <code><a href="../reference/Spower.html">interval()</a></code> (not run).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># p_single.t(n=100, mean=interval(.1, 3)) |&gt; Spower(power=.8)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="criterion-power-analysis">Criterion power analysis<a class="anchor" aria-label="anchor" href="#criterion-power-analysis"></a>
</h3>
<p>Finally, in criterion power analysis the goal is to locate the
associated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
level (<code>sig.level</code>) required to achieve a target power output
holding constant the other modeling information. This is done in
<code><a href="../reference/Spower.html">Spower()</a></code> by setting the <code>sig.level</code> input to
<code>NA</code> while providing values for the other parameters. Note
that technically no search interval is require in this context as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
necessarily lies between the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">p_single.t</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, mean<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.8</span>, sig.level<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:17</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    50   0.5        <span style="color: #BB0000;">NA</span>   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of sig.level: 0.010</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [0.009, 0.010]</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="multiple-power-evaluation-functions">Multiple power evaluation functions<a class="anchor" aria-label="anchor" href="#multiple-power-evaluation-functions"></a>
</h2>
<p>The following functions, <code><a href="../reference/Spower.html">SpowerBatch()</a></code> and
<code><a href="../reference/Spower.html">SpowerCurve()</a></code>, can be used to evaluate and visualize power
analysis results across a range of inputs rather than a single set of
fixed inputs. This section demonstrates their general usage, as their
specifications slightly differ from that of <code><a href="../reference/Spower.html">Spower()</a></code>,
despite the fact that <code><a href="../reference/Spower.html">Spower()</a></code> is the underlying estimation
engine.</p>
<div class="section level3">
<h3 id="spowerbatch">SpowerBatch()<a class="anchor" aria-label="anchor" href="#spowerbatch"></a>
</h3>
<p>To begin, suppose that there were interest in evaluating the
<code>p_single.t()</code> function across multiple
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
inputs to obtain estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">1-\beta</annotation></semantics></math>.
While this could be performed using independent calls to
<code><a href="../reference/Spower.html">Spower()</a></code>, the function <code><a href="../reference/Spower.html">SpowerBatch()</a></code> can be
used instead, where the variable inputs can be specified in a suitable
vector format.</p>
<p>For instance, given the effect size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>.5</mn></mrow><annotation encoding="application/x-tex">\mu=.5</annotation></semantics></math>,
what would the power be to reject the null hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><mi>μ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\, \mu=0</annotation></semantics></math>
across three different sample sizes,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>30</mn><mo>,</mo><mn>60</mn><mo>,</mo><mn>90</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">N = [30,60,90]</annotation></semantics></math>?</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">p_single.t</span><span class="op">(</span>mean<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">SpowerBatch</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">prospective.batch</span></span>
<span><span class="va">prospective.batch</span></span></code></pre></div>
<pre><code><span><span class="co">## $CONDITION_1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:03</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    30   0.5      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.752</span></span>
<span><span class="co">## 95% Confidence Interval: [0.743, 0.760]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $CONDITION_2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:03</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    60   0.5      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.967</span></span>
<span><span class="co">## 95% Confidence Interval: [0.963, 0.970]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $CONDITION_3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:03</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    90   0.5      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.996</span></span>
<span><span class="co">## 95% Confidence Interval: [0.995, 0.997]</span></span></code></pre>
<p>This can further be coerced to a <code>data.frame</code> object if
there is reason to do so (e.g., for plotting purposes, though see also
<code><a href="../reference/Spower.html">SpowerCurve()</a></code>).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">prospective.batch</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    n mean sig.level  power    CI_2.5   CI_97.5</span></span>
<span><span class="co">## 1 30  0.5      0.05 0.7516 0.7431313 0.7600687</span></span>
<span><span class="co">## 2 60  0.5      0.05 0.9669 0.9633937 0.9704063</span></span>
<span><span class="co">## 3 90  0.5      0.05 0.9963 0.9951100 0.9974900</span></span></code></pre>
<p>Similarly, if the were related to a priori analyses for sample size
planning then the inputs to <code><a href="../reference/Spower.html">SpowerBatch()</a></code> would be modified
to set <code>n</code> to the missing quantity.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">apriori.batch</span> <span class="op">&lt;-</span> <span class="fu">p_single.t</span><span class="op">(</span>mean<span class="op">=</span><span class="fl">.5</span>, n<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">SpowerBatch</a></span><span class="op">(</span>power<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.7</span>, <span class="fl">.8</span>, <span class="fl">.9</span><span class="op">)</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">apriori.batch</span></span></code></pre></div>
<pre><code><span><span class="co">## $CONDITION_1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:41</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.5      0.05   0.7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 26.7</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [26.5, 27.0]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $CONDITION_2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:21</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.5      0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 33.3</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [32.9, 33.7]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $CONDITION_3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:33</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.5      0.05   0.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 44.4</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [43.8, 44.8]</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">apriori.batch</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          n mean sig.level power   CI_2.5  CI_97.5</span></span>
<span><span class="co">## 1 26.71726  0.5      0.05   0.7 26.46683 26.96011</span></span>
<span><span class="co">## 2 33.31082  0.5      0.05   0.8 32.90640 33.69844</span></span>
<span><span class="co">## 3 44.36998  0.5      0.05   0.9 43.76155 44.84176</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="spowercurve">SpowerCurve()<a class="anchor" aria-label="anchor" href="#spowercurve"></a>
</h3>
<p>Often times researchers wish to visualize the results of power
analyses in the form of graphical representations. <code>Spower</code>
supports various types of visualizations through the function
<code><a href="../reference/Spower.html">SpowerCurve()</a></code>, which creates power curve plots of
previously obtained results (e.g., via <code><a href="../reference/Spower.html">SpowerBatch()</a></code>) or
for to-be-explored inputs. Importantly, each graphic contains estimates
of the Monte Carlo sampling uncertainty to deter over-interpretation of
any resulting point-estimates.</p>
<p>To demonstrate, suppose one were interested in visualizing the power
for the running single-sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
test across four different sample sizes,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>30</mn><mo>,</mo><mn>60</mn><mo>,</mo><mn>90</mn><mo>,</mo><mn>120</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">N=[30,60,90,120]</annotation></semantics></math>.
To do this requires passing the simulation experiment and varying
information to the function <code><a href="../reference/Spower.html">SpowerCurve()</a></code>, which fills in
the variable information to the supplied simulation experiment and plots
the resulting output.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">p_single.t</span><span class="op">(</span>mean<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">SpowerCurve</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">120</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpowerIntro_files/figure-html/unnamed-chunk-31-1.png" class="r-plt" alt="" width="700"></p>
<p>Alternatively, were the above information already evaluated using
<code><a href="../reference/Spower.html">SpowerBatch()</a></code> then this <code>batch</code> object could be
passed directly to <code><a href="../reference/Spower.html">SpowerCurve()</a></code>’s argument
<code>batch</code>, thereby avoiding the need to re-evaluate the
simulation experiments.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pass previous SpowerBatch() object</span></span>
<span><span class="fu"><a href="../reference/Spower.html">SpowerCurve</a></span><span class="op">(</span>batch<span class="op">=</span><span class="va">batch</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/Spower.html">SpowerCurve()</a></code> will accept as many arguments as exists in
the supplied simulation experiment definition, however it will only
provide aesthetic mappings for the first three variable input
specifications as anything past this becomes more difficult to display
automatically. Below is an example that varies both the <code>n</code>
input as well as the input <code>mean</code>, where the first input
appears on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-axis
while the second is mapped to the default colour aesthetic in
<code>ggplot2</code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">p_single.t</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">SpowerCurve</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">120</span><span class="op">)</span>, mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.5</span>, <span class="fl">.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpowerIntro_files/figure-html/unnamed-chunk-35-1.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
