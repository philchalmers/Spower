<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Type M and Type S errors • Spower</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Type M and Type S errors">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Spower</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/gpower_examples.html">G*Power examples evaluated with Spower</a></li>
    <li><a class="dropdown-item" href="../articles/original/gpower_examples.html">G*Power examples evaluated with Spower</a></li>
    <li><a class="dropdown-item" href="../articles/Spower_TypeSM.html">Type M and Type S errors</a></li>
    <li><a class="dropdown-item" href="../articles/SpowerIntro_logicals.html">Logical Vectors, Bayesian power analyses, and ROPEs</a></li>
    <li><a class="dropdown-item" href="../articles/SpowerIntro.html">Introduction to the Spower package</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/Spower/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Type M and Type S errors</h1>
                        <h4 data-toc-skip class="author">Phil
Chalmers</h4>
            
            <h4 data-toc-skip class="date">February 10, 2026</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/Spower/blob/main/vignettes/Spower_TypeSM.Rmd" class="external-link"><code>vignettes/Spower_TypeSM.Rmd</code></a></small>
      <div class="d-none name"><code>Spower_TypeSM.Rmd</code></div>
    </div>

    
    
<p><em>Gelman, A., &amp; Carlin, J. (2014). Beyond Power Calculations:
Assessing Type S (Sign) and Type M (Magnitude) Errors. Perspectives on
Psychological Science, 9(6), 641-651. <a href="https://doi.org/10.1177/1745691614551642" class="external-link uri">https://doi.org/10.1177/1745691614551642</a></em></p>
<p>In the publication above, Gelman and Carlin (2014) present
<em>conditional</em> power analysis ideas to investigate <em>Type S</em>
and <em>Type M</em> errors, which add augmentations to the usual
evaluation of power via the average (expected) rejection of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
or support for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>
across independent samples. Specifically:</p>
<ul>
<li>
<strong>Type S errors</strong> occur when a null hypothesis is
confidently rejected in light of the alternative being true, however
<em>the rejection is in the wrong direction of the underlying
effect</em>. Hence, conditional on a “statistical significance”
decision, what is the probability that the correct sign was inferred?
<ul>
<li>Ideally Type S errors should be close to 0.</li>
<li>In the limiting case, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
is true (no effect at all), then<br>
Type S errors will be .50 as the sign will be a coin-flip</li>
<li>Type S errors are particularly prevalent in under powered research
studies, where the sampling variability could result in detection of an
effect that happens to be <em>opposite</em> what should have been
detected from the population generating structure</li>
</ul>
</li>
<li>
<strong>Type M errors</strong>, on the other hand, occur when the
<em>magnitude</em> of a detected effect is <em>much larger</em> than the
expected effect given that “statistical significance” has occurred.
<ul>
<li>Gelman and Carlin (2014) presented this as a ratio idea
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mo stretchy="true" form="prefix">|</mo><mi>e</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy="true" form="postfix">|</mo></mrow><mrow><mi>p</mi><mi>a</mi><mi>r</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M=E(\frac{|estimate|}{parameter})</annotation></semantics></math>),
where large ratios indicate that the estimate had to be on average that
many times higher than the expected value of the parameter (e.g., a Type
M ratio of 8 indicates that of those effect sizes flagged as significant
the effect estimate had to be on average 8 times larger than the true
parameter).</li>
</ul>
</li>
</ul>
<p>Note that while the ratio for Type M errors gets at the idea nicely
as it indicates a type of conditional “exaggeration” effect, nothing
really precludes us from drawing further lines in the sand to better map
this concept into a power framework. For instance, if we would only be
confidence that our sample size is “large enough” if we only treat
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
ratios less than, say, 2 or 3, then <code>TRUE/FALSE</code> values could
be used to indicate that the observed sample has passed the desired
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
cut-off.</p>
<div class="section level2">
<h2 id="type-s-errors-via-simulation">Type S errors via simulation<a class="anchor" aria-label="anchor" href="#type-s-errors-via-simulation"></a>
</h2>
<p>To demonstrate how to estimate Type S errors via simulation, the
following simulation experiment performs a two-sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test
with a “small” effect size (Cohen’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>.2</mn></mrow><annotation encoding="application/x-tex">d=.2</annotation></semantics></math>)
with smaller sample sizes. The first implementation demonstrate the
logic with a user-defined data generation and analysis, while the second
approach demonstrates how the <code>p_*</code> functions defined within
<code>Spower</code> can be used instead — provided that they are
relevant to the power analysis under investigation.</p>
<div class="section level3">
<h3 id="manual-specification">Manual specification<a class="anchor" aria-label="anchor" href="#manual-specification"></a>
</h3>
<p>In the manual implementation, where the user write both the data
generation and analysis components themselves into a single function,
the use of a <code>while()</code> loop is required to generate and
analyse the experiment until a significant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
is observed. When observed, the <code>while()</code> loop is then
terminated as the generated data matches the conditional significance
criterion, at which point the subsequent analyses relevant to the
compliment of Type S error (the <em>correct</em> sign decision) is
returned as a <code>logical</code> so that conditional power will be
reflected in the output.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_two.t_correct.sign</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">mu</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">.05</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">while</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>        <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span>        <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">g2</span>, <span class="va">g1</span>, mu<span class="op">=</span><span class="va">mu</span>, <span class="va">...</span><span class="op">)</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="va">alpha</span><span class="op">)</span> <span class="kw">break</span>   <span class="co"># if "significant" then break while() loop</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">mean_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">mean_diff</span> <span class="op">&gt;</span> <span class="va">mu</span>                      <span class="co"># return TRUE if the correct sign is observed</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">l_two.t_correct.sign</span><span class="op">(</span>n<span class="op">=</span><span class="fl">15</span>, mean<span class="op">=</span><span class="fl">.2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:22</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    15   0.2      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.924</span></span>
<span><span class="co">## 95% Confidence Interval: [0.919, 0.929]</span></span></code></pre>
<p>From the output from <code><a href="../reference/Spower.html">Spower()</a></code>, the <code>power</code>
information reflects the estimated probability that the correct sign
decision was made given that “significance” was observed, while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>p</mi><mi>o</mi><mi>w</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">1-power</annotation></semantics></math>
provides the estimate of the associated Type S error (probability of an
incorrect sign given significance). As can be seen, there is about a
0.9241 probability of making the correct sign decision about the true
effect, and a complimentary probability estimate of 0.0759 of making a
Type S error.</p>
<p>With <code>Spower</code>, it’s of course possible to evaluate other
input properties associated with these power values. For instance,
suppose that we wish to know the requisite sample size such that Type S
errors are made with very little frequency (hence, high conditional sign
power). Further suppose we only want to make a Type S error, say, 1/100
times a significant effect is observed. The following code evaluates how
to obtain such an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
estimate.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">typeS</span> <span class="op">&lt;-</span> <span class="fl">.01</span></span>
<span><span class="fu">l_two.t_correct.sign</span><span class="op">(</span>n<span class="op">=</span><span class="cn">NA</span>, mean<span class="op">=</span><span class="fl">.2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">1</span><span class="op">-</span><span class="va">typeS</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:18</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.2      0.05  0.99</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 47.7</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [44.1, 51.7]</span></span></code></pre>
<p>Hence, one would need a sample size of approximately 48 per group in
order to have a Type S error be approximately 1%.</p>
</div>
<div class="section level3">
<h3 id="implementation-using-built-in-p_t-test-function">Implementation using built-in <code>p_t.test()</code> function<a class="anchor" aria-label="anchor" href="#implementation-using-built-in-p_t-test-function"></a>
</h3>
<p>Alternatively, if the simulation function and analysis already appear
in the context of the package definition then <code>Spower</code>’s
internally defined <code>p_*</code> functions can be used in place of
the complete manual implementation. This is beneficial as the data
generation and analysis components then do not need to be written by the
front-end user, potentially avoiding implementation issues using
previously defined simulation experiment code.</p>
<p>As a reminder, the default <code>p_*</code> functions in the package
always return a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
under the null hypothesis specified as this is the canonical way in
which power analysis via simulation is explored (cf. posterior
probability approaches). However, these simulation experiment functions
also contain a logical argument <code>return_analysis</code>, which if
set to <code>TRUE</code> will return the complete analysis object
instead of just the extracted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
(most commonly in the element <code>p.value</code>, though please use
functions like <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code> to inspect fully). For Type M/S errors
multiple components are clearly required, and therefore further
information should be extracted from the analysis objects directly to
accommodate.</p>
<p>To demonstrate, the built-in function <code><a href="../reference/p_t.test.html">p_t.test()</a></code> is used
with the <code>return_analysis = TRUE</code> argument. The simulation
experiment still follows the <code>while()</code> loop logic to ensure
that “significance” is first flagged, however the internal function
definitions now provide the data generation and analyses so that the
front-end user does not have to.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_two.t_correct.sign</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">mu</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">.05</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">while</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="co"># return_analysis argument used to return model object</span></span>
<span>        <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>, d<span class="op">=</span><span class="va">mean</span>, mu<span class="op">=</span><span class="va">mu</span>, return_analysis<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="va">alpha</span><span class="op">)</span> <span class="kw">break</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">mean_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">mean_diff</span> <span class="op">&gt;</span> <span class="va">mu</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">l_two.t_correct.sign</span><span class="op">(</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Setting the sample size to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>30</mn></mrow><annotation encoding="application/x-tex">N=30</annotation></semantics></math>
(hence, <code>n=15</code>) leads to the following power estimates.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">l_two.t_correct.sign</span><span class="op">(</span>n<span class="op">=</span><span class="fl">15</span>, mean<span class="op">=</span><span class="fl">.2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:29</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    15   0.2      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.925</span></span>
<span><span class="co">## 95% Confidence Interval: [0.920, 0.930]</span></span></code></pre>
<p>If at all possible it is recommended to use the
<code>return_analysis</code> approach as the simulation experiments
defined within the package have all been well tested. The trade-off, as
it is with all higher-level functions in R, is that there will often be
slightly more overhead than user-defined functions, though of course the
latter approach comes at the cost of safety.</p>
</div>
</div>
<div class="section level2">
<h2 id="type-m-errors-via-simulation">Type M errors via simulation<a class="anchor" aria-label="anchor" href="#type-m-errors-via-simulation"></a>
</h2>
<p>Continuing with the above two-sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test
structure, suppose we’re interested in minimizing Type M errors to
ensure that significant results weren’t due to higher sampling
variability, ultimately resulting in significance being raised only when
unreasonably large effect sizes estimates are observed. For the purpose
of this power demonstration, suppose “unreasonably large” is defined
such that the ratio of the absolute (standardized) mean difference in a
two-sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test,
which was flagged as significant, was larger than three times the value
of the true (standardized) mean difference (hence,
<code>M.ratio = 3</code>).</p>
<p>Note that while focusing on an <code>M.ratio = 3</code> provides the
sufficient means to study Type M errors using a cut-off logic to define
power, it is also possible to store the observed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
values for further inspection too, which can be done in
<code>Spower</code> if a <code>list</code> or <code>data.frame</code> is
returned from the supplied experiment. For this to behave correctly,
however, output information relevant to the <code>power</code>
computations (probability values/logicals) must be explicitly specified
using <code>Spower(..., select)</code> so that other values returned
from the simulation are stored but not summarised.</p>
<p>As before, the first step is to define the experiment using the
conditional
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
logic nested within a <code>while()</code> loop, followed by the power
(and extra) criteria of interest.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_two.t_typeM</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">mu</span> <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                          <span class="va">alpha</span> <span class="op">=</span> <span class="fl">.05</span>, <span class="va">M.ratio</span> <span class="op">=</span> <span class="fl">3</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">while</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="co"># return_analysis argument used to return model object</span></span>
<span>        <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>, d<span class="op">=</span><span class="va">mean</span>, mu<span class="op">=</span><span class="va">mu</span>, return_analysis<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="va">alpha</span><span class="op">)</span> <span class="kw">break</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">/</span><span class="va">mean</span></span>
<span>    <span class="co"># return data.frame, where "retain" indicates the (logical) power information</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>retain<span class="op">=</span><span class="va">M</span> <span class="op">&lt;</span> <span class="va">M.ratio</span>, M<span class="op">=</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>With
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">N=50</annotation></semantics></math>
per group and a “small” standardized effect size of .2 gives the
following.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># only use the "retain" information to compute power, though store the rest</span></span>
<span><span class="fu">l_two.t_typeM</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, mean<span class="op">=</span><span class="fl">.2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>select<span class="op">=</span><span class="st">'retain'</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">typeM</span></span>
<span><span class="va">typeM</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:19</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    50   0.2      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.861</span></span>
<span><span class="co">## 95% Confidence Interval: [0.854, 0.868]</span></span></code></pre>
<p>In this case, <code>power</code> represents the probability that,
given a significant result was observed, the resulting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
ratio was less than the cutoff of 3 (hence, was less than three times
the true effect size). The compliment, which reflects the Type M error,
is then 0.139, which is indeed quite high as approximately 14% of the
samples flagged as significant would have needed rather large observed
effects to indicate that the sample was “unusual” in the statistical
significance sense.</p>
<p>With respect to the distribution of the observed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
values themselves, these can be further extracted using
<code><a href="http://philchalmers.github.io/SimDesign/reference/SimResults.html" class="external-link">SimResults()</a></code>. Notice that when plotted, the rejection
magnitudes are not normally distributed, which is to be expected given
the nature of the conditional simulation experiment.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://philchalmers.github.io/SimDesign/reference/SimResults.html" class="external-link">SimResults</a></span><span class="op">(</span><span class="va">typeM</span><span class="op">)</span></span>
<span><span class="va">results</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10,000 × 5</span></span></span>
<span><span class="co">##        n  mean sig.level retain     M</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>    50   0.2      0.05 TRUE    2.47</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>    50   0.2      0.05 TRUE    2.44</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    50   0.2      0.05 TRUE    2.57</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    50   0.2      0.05 TRUE    2.52</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>    50   0.2      0.05 TRUE    2.16</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>    50   0.2      0.05 FALSE   3.59</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>    50   0.2      0.05 TRUE    1.78</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>    50   0.2      0.05 TRUE    2.21</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>    50   0.2      0.05 TRUE    2.79</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>    50   0.2      0.05 FALSE   3.38</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 9,990 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">results</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, SD<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, min<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, max<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      mean        SD       min       max </span></span>
<span><span class="co">## 2.4863313 0.4696919 1.6198006 5.3105530</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">M</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="Spower_TypeSM_files/figure-html/unnamed-chunk-16-1.png" class="r-plt" alt="" width="700"></p>
<p>Finally, increasing the sample size greatly helps with the Type M
issues, as seen below by doubling the sample size below.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># double the total sample size</span></span>
<span><span class="fu">l_two.t_typeM</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">.2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>select<span class="op">=</span><span class="st">'retain'</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">typeM2</span></span>
<span><span class="va">typeM2</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:14</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   100   0.2      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.991</span></span>
<span><span class="co">## 95% Confidence Interval: [0.989, 0.993]</span></span></code></pre>
<p>where the Type M error for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>.</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">M.ratio = 3</annotation></semantics></math>
cutoff is now</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">last</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getLastSpower.html">getLastSpower</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="va">last</span><span class="op">$</span><span class="va">power</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0088</span></span></code></pre>
<p>so approximately 1% of the significant results would have been due to
an overly large effect size estimate. Again, the distributional
properties of the observed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
values can be extracted and further analyzed should the need arise.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://philchalmers.github.io/SimDesign/reference/SimResults.html" class="external-link">SimResults</a></span><span class="op">(</span><span class="va">typeM2</span><span class="op">)</span></span>
<span><span class="va">results</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10,000 × 5</span></span></span>
<span><span class="co">##        n  mean sig.level retain     M</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>   100   0.2      0.05 TRUE    1.43</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>   100   0.2      0.05 TRUE    1.45</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>   100   0.2      0.05 TRUE    1.83</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>   100   0.2      0.05 TRUE    1.72</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   100   0.2      0.05 TRUE    1.98</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   100   0.2      0.05 TRUE    1.61</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   100   0.2      0.05 TRUE    2.01</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   100   0.2      0.05 TRUE    2.52</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>   100   0.2      0.05 TRUE    1.48</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>   100   0.2      0.05 TRUE    1.49</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 9,990 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">results</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, SD<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, min<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, max<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      mean        SD       min       max </span></span>
<span><span class="co">## 1.8333941 0.3667748 1.2174419 4.4615467</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">M</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="Spower_TypeSM_files/figure-html/unnamed-chunk-21-1.png" class="r-plt" alt="" width="700"></p>
<p>Type M errors are of course intimately related to <em>precision
criteria</em> in power analyses, and in that sense are an alternative
way of looking at power planning to help from relying on “extreme”
observations. Personally, the notion of thinking in terms of “ratios
relative to the true population effect size” feels somewhat unnatural,
though the point is obviously important as seeing significance flagged
only when unreasonably large effect sizes occur is indeed troubling
(e.g., replication issues).</p>
<p>In contrast then, I would recommend using precision-based power
planning over focusing explicitly on Type M errors when power planning
as this seems more natural, where obtaining greater precision in the
target estimates will necessarily decrease the number of Type M error in
both the “extreme” and “underwhelming” sense of the effect size
estimates (the ladder of which Type M errors do not address as they do
not focus on non-significant results by definition). More importantly,
precision criteria are framed in the metric of the parameters relevant
to the data analyst rather than on a metricless effect size ratio, which
in general should be more natural to specify.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
