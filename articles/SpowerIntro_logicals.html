<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Logical Vectors, Bayesian power analyses, and ROPEs • Spower</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Logical Vectors, Bayesian power analyses, and ROPEs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Spower</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/gpower_examples.html">G*Power examples evaluated with Spower</a></li>
    <li><a class="dropdown-item" href="../articles/original/gpower_examples.html">G*Power examples evaluated with Spower</a></li>
    <li><a class="dropdown-item" href="../articles/Spower_TypeSM.html">Type M and Type S errors</a></li>
    <li><a class="dropdown-item" href="../articles/SpowerIntro_logicals.html">Logical Vectors, Bayesian power analyses, and ROPEs</a></li>
    <li><a class="dropdown-item" href="../articles/SpowerIntro.html">Introduction to the Spower package</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/Spower/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Logical Vectors, Bayesian power analyses, and ROPEs</h1>
                        <h4 data-toc-skip class="author">Phil
Chalmers</h4>
            
            <h4 data-toc-skip class="date">February 13, 2026</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/Spower/blob/main/vignettes/SpowerIntro_logicals.Rmd" class="external-link"><code>vignettes/SpowerIntro_logicals.Rmd</code></a></small>
      <div class="d-none name"><code>SpowerIntro_logicals.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="logical-returns">Logical returns<a class="anchor" aria-label="anchor" href="#logical-returns"></a>
</h2>
<p>In many applications it can be advantageous to directly return
<code>logical</code> values in the simulation experiment rather than
letting <code><a href="../reference/Spower.html">Spower()</a></code> perform these threshold transformations
internally (e.g., using <code>sig.level</code>) as these can include
more intricate experimental requirements. The following showcases
various ways that returning <code>logical</code> values works in the
<code>Spower</code> package, where the average across the collected
<code>TRUE</code>/<code>FALSE</code> values reflects the target power
estimate.</p>
<p>Note that returning a <code>logical</code> in the simulation
experiment necessarily implies that the <code>sig.level</code> argument
in <code><a href="../reference/Spower.html">Spower()</a></code> and friends will not be used, and therefore
suitable alternatives must be defined within the context of the
simulation experiment code (e.g., including <code>conf.level</code> or
<code>sig.level</code> in the simulation experiment function
directly).</p>
<div class="section level3">
<h3 id="confidence-and-credible-intervals">Confidence (and credible) intervals<a class="anchor" aria-label="anchor" href="#confidence-and-credible-intervals"></a>
</h3>
<p>Keeping with the basic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test
experiment in the introduction vignette, suppose we’re interested in the
power to reject the null hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0:\, \mu = \mu_0</annotation></semantics></math>
in a one-sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(D|H_0)</annotation></semantics></math>
is the probability of the observing the data given the null hypothesis.
Normally, one could simply write an experiment that returns a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
in this context, such as the following,</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_single.t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">mu</span><span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">g</span>, mu<span class="op">=</span><span class="va">mu</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>    <span class="va">p</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>However, an equivalent way to explore power in this context would be
to investigate the same null hypothesis via <em>confidence
intervals</em> given a specific
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
level to define their range, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>I</mi><mi>μ</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>C</mi><msub><mi>I</mi><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo>,</mo><mi>C</mi><msub><mi>I</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">CI_\mu=[CI_{\alpha/2},CI_{1-\alpha/2}]</annotation></semantics></math>.</p>
<p>If one were to take this approach, the defined simulation function
should return a <code>logical</code> value based on the relation of the
parameter estimate to the CI, where the CI is used to evaluate the
plausibility of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><msub><mi>μ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\mu = \mu_0</annotation></semantics></math>.
Specifically, in the context of using CI’s to reflect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
logic, the CI is used to evaluate whether
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\mu_0</annotation></semantics></math>
falls <em>outside</em> the advertised interval, returning
<code>TRUE</code> if outside the CI and <code>FALSE</code> if within the
interval. Alternatively, if one were in a Bayesian analysis context, a
<em>credible interval</em> could be used instead of the confidence
interval to construct the same logical output.</p>
<p>The following code demonstrates this logic, assuming that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>.05</mn></mrow><annotation encoding="application/x-tex">\alpha = .05</annotation></semantics></math>
(and therefore a two-tailed, 95% CI is used), and uses the
<code><a href="../reference/is.outside_CI.html">is.outside_CI()</a></code> function to evaluate whether the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\mu_0</annotation></semantics></math>
parameter falls outside the estimated <code>CI</code> returned from
<code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_single.t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">mu</span><span class="op">=</span><span class="fl">0</span>, <span class="va">conf.level</span><span class="op">=</span><span class="fl">.95</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">g</span>, mu<span class="op">=</span><span class="va">mu</span>, conf.level<span class="op">=</span><span class="va">conf.level</span><span class="op">)</span></span>
<span>    <span class="va">CI</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">conf.int</span></span>
<span>    <span class="fu"><a href="../reference/is.outside_CI.html">is.outside_CI</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">CI</span><span class="op">)</span>   <span class="co"># equivalent to: !(CI[1] &lt; mu &amp;&amp; mu &lt; CI[2])</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">l_single.t</span><span class="op">(</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">.2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Evaluating the power analysis with <code><a href="../reference/Spower.html">Spower()</a></code> works out of
the box now, noting again that <code>l_single.t()</code> will ignore the
<code>Spower(..., sig.level)</code> information altogether as it is no
longer relevant when <code>logical</code> information is returned. The
following compares both the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
and logical CI approaches, both of which provide identical inferential
information in this case (this will not always be true; the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test
simply reflects a special case).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">p_single.t</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:03</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   100   0.3      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.846</span></span>
<span><span class="co">## 95% Confidence Interval: [0.839, 0.853]</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">l_single.t</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:04</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   100   0.3      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.841</span></span>
<span><span class="co">## 95% Confidence Interval: [0.834, 0.849]</span></span></code></pre>
<div class="section level4">
<h4 id="using-previouls-defined-simulation-code">Using previouls defined simulation code<a class="anchor" aria-label="anchor" href="#using-previouls-defined-simulation-code"></a>
</h4>
<p>Note that even in the CI context presented above, writing
user-defined functions may not be entirely necessary. This is because
the related, internally defined function <code><a href="../reference/p_t.test.html">p_t.test()</a></code> can be
used to obtain the same CI information by returning the model itself,
and subsequently extracting the <code>$conf.int</code> element. The
benefit of this, as shown below, is that users do not need to reinvent
the data generation and analysis portions of the experiment if this is
already available in the package.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_single.t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">mu</span><span class="op">=</span><span class="fl">0</span>, <span class="va">conf.level</span><span class="op">=</span><span class="fl">.95</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># return analysis output from t.test() for further extraction</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>, d<span class="op">=</span><span class="va">mean</span>, mu<span class="op">=</span><span class="va">mu</span>, type<span class="op">=</span><span class="st">'one.sample'</span>, </span>
<span>                    conf.level<span class="op">=</span><span class="va">conf.level</span>, return_analysis<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">CI</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">conf.int</span></span>
<span>    <span class="fu"><a href="../reference/is.outside_CI.html">is.outside_CI</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">CI</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">l_single.t</span><span class="op">(</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">.2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="precision-criterion">Precision criterion<a class="anchor" aria-label="anchor" href="#precision-criterion"></a>
</h3>
<p>Using confidence or credible intervals are also useful in contexts
where specific <em>precision</em> criteria are important to satisfy.
Suppose that, in addition to detecting a particular effect of interest
in a given sample, the results are only deemed “practically useful” if
the resulting effect size inferences are sufficiently precise, where
precision could be based on the <em>magnitude of the SE</em>, the
<em>width of the uncertainty interval</em>, or other relevant
precision-based criterion. In this case, one may join the logic of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value/CI
approaches to create a joint evaluation for power, where a result is
deemed both “significant and useful” if the null hypothesis is
significantly rejected <em>and</em> the CI is sufficiently narrow.</p>
<p>As a working example, suppose that the above one-sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test
experiment was generalized such that a meaningfully significant result
would require a) the rejection of the null,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu_0=0</annotation></semantics></math>,
and b) a CI width less than 1/4 standardized mean units. What value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
would be required to obtain such a significant and sufficiently accurate
inference to obtain a power of 80% given, say, the “small” effect size
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">d=0.2</annotation></semantics></math>?</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_precision</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">CI.width</span>, <span class="va">mu</span><span class="op">=</span><span class="fl">0</span>, <span class="va">alpha</span><span class="op">=</span><span class="fl">.05</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">g</span>, mu<span class="op">=</span><span class="va">mu</span><span class="op">)</span></span>
<span>    <span class="va">CI</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">conf.int</span></span>
<span>    <span class="va">width</span> <span class="op">&lt;-</span> <span class="va">CI</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">CI</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="co"># return TRUE if significant and CI is sufficiently narrow</span></span>
<span>    <span class="va">out</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="va">alpha</span> <span class="op">&amp;&amp;</span> <span class="va">width</span> <span class="op">&lt;</span> <span class="va">CI.width</span>   </span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">l_precision</span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">500</span><span class="op">)</span>, mean<span class="op">=</span><span class="fl">.2</span>, CI.width<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.80</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># equivalently: </span></span>
<span><span class="co"># l_precision(n=NA, mean=.2, CI.width=1/4) |&gt; </span></span>
<span><span class="co">#    Spower(power=.80, interval=c(10, 500))</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:22</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n  mean sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.2      0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 272.6</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [272.0, 273.2]</span></span></code></pre>
<p>Compared to the required
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
from a power analysis that just contains a significant result, this
joint practical significance criteria requires a meaningfully higher
sample size. Note that in the special case where
<code>CI.width=Inf</code> then all CI widths will be accepted, which
will result in the same power output that would have been obtained using
<code>p_single.t()</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">l_precision</span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">500</span><span class="op">)</span>, mean<span class="op">=</span><span class="fl">.2</span>, CI.width<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.80</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:20</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n  mean CI.width sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>   0.2      <span style="color: #BB0000;">Inf</span>      0.05   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 198.8</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [197.2, 200.2]</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="bayes-factors">Bayes Factors<a class="anchor" aria-label="anchor" href="#bayes-factors"></a>
</h3>
<p>If one were using a Bayesian analysis criteria rather than the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
approach, the Bayes factor
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">BF</annotation></semantics></math>)
ratio could be used in the <code>logical</code> return context too. For
example, returning whether the observed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>F</mi><mo>&gt;</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">BF&gt;3</annotation></semantics></math>
in a given random sample would indicate at least “moderate” supporting
evidence for the hypothesis of interest compared to some competing
hypothesis (often the complementary null,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(H_0|D)</annotation></semantics></math>,
though not necessarily), and the average across the independent samples
would indicate the degree of power when using this Bayes factor
cut-off.</p>
<p>The downside of focusing on BFs is that they require the computation
of the marginal likelihoods, typically via bridge sampling (e.g., via
the <code>bridgesampling</code> package), in addition to fitting the
model using Markov chain Monte Carlo (MCMC) methods (e.g.,
<code>brms</code>, <code>rstan</code>, <code>rstanarm</code>). Though
not a strict limitation per se, it is often more natural to focus
directly on the sample from posterior distribution for power analysis
applications rather than on the marginal Bayes factors; this is
demonstrated in the next section. Nevertheless, such applications are
possible with <code>Spower</code> if there is sufficient interest in
doing so.</p>
<p>As a simple example, the following one-sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test,
initially defined above, could be redefined to focus on output from the
<code>BayesFactor</code> package, which returns the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">BF</annotation></semantics></math>
criteria in log units (hence, <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp()</a></code> is used to return the
ratio to its original metric) assuming a non-informative Jeffreys prior
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>.
In this case a <code>TRUE</code> is returned if the Bayes factor is
greater than 3 and <code>FALSE</code> if less than or equal to 3.</p>
<p>Finally, to ensure that nothing important is lost in the simulation
experiment code a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code> object is returned instead
of just the <code>logical</code> information, while
<code><a href="../reference/Spower.html">Spower()</a></code> is informed to only focus on the
<code>logical</code> information for the purpose of the power
computations.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_single.Bayes.t_BF</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">mu</span><span class="op">=</span><span class="fl">0</span>, <span class="va">bf.cut</span><span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">BayesFactor</span><span class="fu">::</span><span class="fu">ttestBF</span><span class="op">(</span><span class="va">g</span>, mu<span class="op">=</span><span class="va">mu</span><span class="op">)</span>   </span>
<span>    <span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">res</span><span class="op">@</span><span class="va">bayesFactor</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># Bayes factor</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>largeBF<span class="op">=</span><span class="va">bf</span> <span class="op">&gt;</span> <span class="va">bf.cut</span>, bf<span class="op">=</span><span class="va">bf</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Evaluating this simulation with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">N=100</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>.5</mn></mrow><annotation encoding="application/x-tex">\mu=.5</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>0</mn></msub><mo>=</mo><mn>.3</mn></mrow><annotation encoding="application/x-tex">\mu_0=.3</annotation></semantics></math>
gives the following power estimate.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">l_single.Bayes.t_BF</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">.5</span>, mu<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>select<span class="op">=</span><span class="st">'largeBF'</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">BFsim</span></span>
<span><span class="va">BFsim</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:01:24</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n  mean    mu sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   100   0.5   0.3      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.265</span></span>
<span><span class="co">## 95% Confidence Interval: [0.257, 0.274]</span></span></code></pre>
<p>To view the complete simulation results use <code><a href="http://philchalmers.github.io/SimDesign/reference/SimResults.html" class="external-link">SimResults()</a></code>
on the resulting output, which if useful could be further plotted. Note
that when plotting Bayes factors it is advantageous to present the plot
in natural log units.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BFresults</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://philchalmers.github.io/SimDesign/reference/SimResults.html" class="external-link">SimResults</a></span><span class="op">(</span><span class="va">BFsim</span><span class="op">)</span></span>
<span><span class="va">BFresults</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10,000 × 6</span></span></span>
<span><span class="co">##        n  mean    mu sig.level largeBF      bf</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>   100   0.5   0.3      0.05 FALSE     0.131</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>   100   0.5   0.3      0.05 FALSE     1.04 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>   100   0.5   0.3      0.05 FALSE     2.73 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>   100   0.5   0.3      0.05 TRUE     43.4  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   100   0.5   0.3      0.05 FALSE     0.168</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   100   0.5   0.3      0.05 FALSE     1.06 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   100   0.5   0.3      0.05 TRUE      3.73 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   100   0.5   0.3      0.05 TRUE    442.   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>   100   0.5   0.3      0.05 TRUE     11.3  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>   100   0.5   0.3      0.05 TRUE      4.11 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 9,990 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use log-scale for Bayes factors as this is a more useful metric</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">BFresults</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span>, fill<span class="op">=</span><span class="va">largeBF</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins<span class="op">=</span><span class="fl">50</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'log(BF) distribution'</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpowerIntro_logicals_files/figure-html/unnamed-chunk-20-1.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-power-analysis-via-posterior-probabiltes">Bayesian power analysis via posterior probabiltes<a class="anchor" aria-label="anchor" href="#bayesian-power-analysis-via-posterior-probabiltes"></a>
</h2>
<p>The canonical way that <em>Spower</em> has been designed focuses
primarily on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values
involving the null hypothesis to be tested
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(D|H_0)</annotation></semantics></math>).
The reason for setting the package up this way is so that the parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
(<code>sig.level</code>) can be used as the “line-in-the-sand” threshold
to flag whether a null hypothesis was rejected in each sample of data as
this behaviour is common among popular power analysis software. Bayesian
power analysis, on the other hand, are also supported by the package,
where instead the posterior probability of the alternative hypothesis,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(H_1|D)</annotation></semantics></math>,
is the focus of the simulation experiment.</p>
<p>Continuing with the simple one-sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test
example in the introduction vignette and above, were the power analysis
context be that of a Bayesian analysis the conditional probability of
the alternative,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(H_1|D)</annotation></semantics></math>,
may be used instead. For this to work with <em>Spower</em> though, the
argument <code>sig.direction = 'above'</code> should be supplied, where
now the <code>sig.level</code> indicates that “significance” only occurs
when an probability observation is <em>above</em> the define
<code>sig.level</code> cutoff (hence, the default of <code>.05</code> is
no longer reasonable and should be modified).</p>
<p>Below is one such Bayesian approach using posterior probabilities
using the <code>BayesFactor</code> package, which is obtained by
translating the Bayes factor output into a suitable posterior
probability and focusing on the alternative hypothesis (hence, the
posterior probability returned corresponds to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>≠</mo><msub><mi>μ</mi><mn>0</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\mu \ne \mu_0|D)</annotation></semantics></math>).
The following also assumes that the competing hypotheses are equally
likely when obtaining the posterior probability (hence, prior odds are
1:1, reflected in the argument <code>prior_odds</code>).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assuming P(H1)/P(H0) are equally likely; hence, prior_odds = 1</span></span>
<span><span class="va">pp_single.Bayes.t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mean</span>, <span class="va">mu</span>, <span class="va">prior_odds</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">BayesFactor</span><span class="fu">::</span><span class="fu">ttestBF</span><span class="op">(</span><span class="va">g</span>, mu<span class="op">=</span><span class="va">mu</span><span class="op">)</span>   </span>
<span>    <span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">res</span><span class="op">@</span><span class="va">bayesFactor</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># Bayes factor</span></span>
<span>    <span class="va">posterior_odds</span> <span class="op">&lt;-</span> <span class="va">bf</span> <span class="op">*</span> <span class="va">prior_odds</span></span>
<span>    <span class="va">posterior</span> <span class="op">&lt;-</span> <span class="va">posterior_odds</span> <span class="op">/</span> <span class="op">(</span><span class="va">posterior_odds</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>   </span>
<span>    <span class="va">posterior</span>   <span class="co"># P(H_1|D)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>For the Bayesian
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test
definition in the next code chunk evaluation, “significance” is obtained
whenever the sample posterior is <em>greater</em> than
<code>sig.level = .90</code>, demonstrating strong support of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>.
Note that this is a more strict criteria than the null hypothesis
criteria presented in the introduction vignette, and therefore has
notably lower power.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># power cut-off for a significantly supportive posterior is &gt; 0.90</span></span>
<span><span class="fu">pp_single.Bayes.t</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">.5</span>, mu<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>sig.level <span class="op">=</span> <span class="fl">.90</span>, sig.direction <span class="op">=</span> <span class="st">'above'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:01:23</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n  mean    mu sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   100   0.5   0.3       0.9 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.150</span></span>
<span><span class="co">## 95% Confidence Interval: [0.143, 0.157]</span></span></code></pre>
<p>With this approach all of the power analysis criteria described in
<code><a href="../reference/Spower.html">help(Spower)</a></code> are still possible, where for instance solving
other experimental components (such as the sample size <code>n</code>)
are easy to setup by providing suitable <code>NA</code> argument flags
and search intervals in <code><a href="../reference/Spower.html">Spower()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="regions-of-practical-equivalence-ropes">Regions of practical equivalence (ROPEs)<a class="anchor" aria-label="anchor" href="#regions-of-practical-equivalence-ropes"></a>
</h2>
<p>This section presents two related concepts for estimating the power
where some justifiable equivalence interval is of interest.</p>
<div class="section level3">
<h3 id="equivalence-testing">Equivalence testing<a class="anchor" aria-label="anchor" href="#equivalence-testing"></a>
</h3>
<p>As an alternative approach to the rejection of the null hypothesis
via the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
or CI approaches, there may be interest in evaluating power in the
context of establishing <em>equivalence</em>, or in directional cases
<em>superiority</em> or <em>non-inferiority</em>. The purpose of an
equivalence tests is to establish that, although true differences may
exist between groups, the differences are small enough to be considered
“practically equivalent” in all subsequent applications.</p>
<p>As a running example, suppose that in an independent samples
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test
the two groups might be considered “equivalent” if the true mean
difference in the population is somewhere above
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mi>L</mi></msub><annotation encoding="application/x-tex">\epsilon_L</annotation></semantics></math>
but below
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mi>U</mi></msub><annotation encoding="application/x-tex">\epsilon_U</annotation></semantics></math>,
where the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϵ</mi><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math>s
are used to define the <strong>equivalence interval</strong>. If, for
instance, two groups are to be deemed statistically equivalent given
these boundary locations then, using a two-one sided hypothesis testing
approach (TOST), the two null hypotheses must be evaluated are
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mn>0</mn><mi>a</mi></mrow></msub><mo>:</mo><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>≤</mo><mo>−</mo><msub><mi>ϵ</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">H_{0a}:\, (\mu_1 - \mu_2) \le -\epsilon_L</annotation></semantics></math>
and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mn>0</mn><mi>b</mi></mrow></msub><mo>:</mo><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>≥</mo><msub><mi>ϵ</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">H_{0b}:\,(\mu_1 - \mu_2) \ge \epsilon_U</annotation></semantics></math>
Rejecting both of these null hypotheses leads to the induced
complementary hypothesis of interest
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><mspace width="0.167em"></mspace><msub><mi>ϵ</mi><mi>L</mi></msub><mo>&lt;</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><msub><mi>ϵ</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">H_1:\, \epsilon_L &lt; (\mu_1 - \mu_2) &lt; \epsilon_U</annotation></semantics></math>
or in words, the population mean difference falls within the defined
region of equivalence. Superiority testing and non-inferiority testing
follow the same type of logic, however rather than defining a region of
equivalence only one tail of the equivalence interval is of
interest.</p>
<p>To put numbers to the above expression, suppose that the true mean
difference between the groups was
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>d</mi></msub><mo>=</mo><msub><mi>μ</mi><mn>2</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mu_d = \mu_2 - \mu_1 = 1</annotation></semantics></math>
(labeled <code>delta</code>), and each group had an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>D</mi><mo>=</mo><mn>2.5</mn></mrow><annotation encoding="application/x-tex">SD = 2.5</annotation></semantics></math>
(labeled <code>sds</code>). Furthermore, suppose <em>any</em> true
difference that fell within the equivalence interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mn>2.5</mn><mo>,</mo><mn>2.5</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[-2.5, 2.5]</annotation></semantics></math>
(labeled <code>equiv</code>) would be deemed practically equivalent a
priori. The power to jointly reject the above null hypotheses, and
therefore conclude the groups are practically equivalence
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>),
is evaluated in the following output for an experiment with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">N=100</annotation></semantics></math>
observations
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">n=50</annotation></semantics></math>
for each group).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_equiv.t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">delta</span>, <span class="va">equiv</span>, <span class="va">sds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>                      <span class="va">sig.level</span> <span class="op">=</span> <span class="fl">.025</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="va">sds</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean<span class="op">=</span><span class="va">delta</span>, sd<span class="op">=</span><span class="va">sds</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">outL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">g2</span>, <span class="va">g1</span>, mu<span class="op">=</span><span class="op">-</span><span class="va">equiv</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>    <span class="va">outU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">g2</span>, <span class="va">g1</span>, mu<span class="op">=</span><span class="va">equiv</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>    <span class="va">outL</span> <span class="op">&lt;</span> <span class="va">sig.level</span> <span class="op">&amp;&amp;</span> <span class="va">outU</span> <span class="op">&lt;</span> <span class="va">sig.level</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">l_equiv.t</span><span class="op">(</span><span class="fl">50</span>, delta<span class="op">=</span><span class="fl">1</span>, equiv<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span>, </span>
<span>          sds<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:06</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n delta sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    50     1      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.844</span></span>
<span><span class="co">## 95% Confidence Interval: [0.837, 0.851]</span></span></code></pre>
<p>In this case, the power to conclude that the two groups are
equivalent, expressed as a percentage, is 84%. You can verify that these
computations are correct by comparing to established software for now,
such as via the <code>TOSTER</code> package.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">TOSTER</span><span class="fu">::</span><span class="fu">power_t_TOST</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>,</span>
<span>             delta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             sd <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>             eqb <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>             power <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code></pre></div>
<pre><code>     Two-sample TOST power calculation 

          power = 0.8438747
           beta = 0.1561253
          alpha = 0.025
              n = 50
          delta = 1
             sd = 2.5
         bounds = -2.5, 2.5

NOTE: n is number in *each* group</code></pre>
<p>Again, the same type of logic can be evaluated using <code>CI</code>s
alone, and with the built-in <code><a href="../reference/p_t.test.html">p_t.test()</a></code> function, where in
this case <code>TRUE</code> is returned if the estimated 90%
<code>CI</code> falls within the defined equivalence interval.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l_equiv.t_CI</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">delta</span>, <span class="va">equiv</span>, </span>
<span>                         <span class="va">sds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="va">conf.level</span> <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/p_t.test.html">p_t.test</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">delta</span>, sds<span class="op">=</span><span class="va">sds</span>, conf.level<span class="op">=</span><span class="va">conf.level</span>, </span>
<span>                    return_analysis<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/is.CI_within.html">is.CI_within</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">conf.int</span>, interval<span class="op">=</span><span class="va">equiv</span><span class="op">)</span>  <span class="co"># returns TRUE if CI is within equiv interval</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># an equivalent power analysis for "equivalence tests" via CI evaluations</span></span>
<span><span class="fu">l_equiv.t_CI</span><span class="op">(</span><span class="fl">50</span>, delta<span class="op">=</span><span class="fl">1</span>, equiv<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span>, </span>
<span>          sds<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:05</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##       n delta sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    50     1      0.05 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.851</span></span>
<span><span class="co">## 95% Confidence Interval: [0.844, 0.858]</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="bayesian-approach-to-ropes-hdi-rope">Bayesian approach to ROPEs (HDI + ROPE)<a class="anchor" aria-label="anchor" href="#bayesian-approach-to-ropes-hdi-rope"></a>
</h3>
<p>Finally, though not exhaustively, one could approach the topic of
practical equivalence using Bayesian methods using draws from the
posterior distribution of interest, such as those available from BUGS or
HMC samplers (e.g., <code>stan</code>). This approach is highly similar
to the equivalence testing approach described above, but uses highest
density interval + ROPE in Bayesian modeling instead. Below is one such
example that constructs a simple linear regression model with a binary
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
term that is analysed with <code>rstanarm::stan_glm()</code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/bayestestR/" class="external-link">bayestestR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstanarm/" class="external-link">rstanarm</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">rope.lm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">beta0</span>, <span class="va">beta1</span>, <span class="va">range</span>, <span class="va">sigma</span><span class="op">=</span><span class="fl">1</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># generate data</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, each<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">beta0</span> <span class="op">+</span> <span class="va">beta1</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, sd<span class="op">=</span><span class="va">sigma</span><span class="op">)</span></span>
<span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># run model, but tell stan_glm() to use its indoor voice</span></span>
<span>    <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://philchalmers.github.io/SimDesign/reference/quiet.html" class="external-link">quiet</a></span><span class="op">(</span><span class="fu">rstanarm</span><span class="fu">::</span><span class="fu">stan_glm</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">rope</span> <span class="op">&lt;-</span> <span class="fu">bayestestR</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/rope.html" class="external-link">rope</a></span><span class="op">(</span><span class="va">model</span>, ci<span class="op">=</span><span class="fl">1</span>, range<span class="op">=</span><span class="va">range</span>, parameters<span class="op">=</span><span class="st">"x"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">rope</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>In the above example, the proportion of the sampled posterior
distribution that falls within the ROPE is returned, which works well
with the <code>sig.level</code> argument coupled with
<code>sig.direction = 'above')</code> in <code><a href="../reference/Spower.html">Spower()</a></code> to define
a suitable accept/reject cut-off. Specifically, if
<code>sig.level = .95</code> and <code>sig.direction = 'above')</code>
then the ROPE will only be accepted when the percentage of the posterior
distribution that falls within the defined ROPE is greater than .95.
This can of course be performed manually, returning a <code>TRUE</code>
when satisfied and <code>FALSE</code> otherwise, however in this case it
is not necessary.</p>
<p>Below reports a power estimate given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>50</mn><mo>×</mo><mn>2</mn><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">N=50\times 2=100</annotation></semantics></math>,
where the ROPE criteria is deemed satisfied/significant if 95% of the
posterior distribution for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\beta_1=1</annotation></semantics></math>
falls within the defined range of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>±</mo><mn>.2</mn><mo>→</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>.8</mn><mo>,</mo><mn>1.2</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">1 \pm .2\rightarrow [.8,1.2]</annotation></semantics></math>.
Due to the slower execution speeds of the simulations the power
evaluations are computed using <code>parallel=TRUE</code> to utilize all
available cores.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rope.lm</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, beta0<span class="op">=</span><span class="fl">2</span>, beta1<span class="op">=</span><span class="fl">1</span>, sigma<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>sig.level<span class="op">=</span><span class="fl">.95</span>, sig.direction<span class="op">=</span><span class="st">'above'</span>, parallel<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:04:03</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n beta0 beta1 sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    50     2     1      0.95 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.144</span></span>
<span><span class="co">## 95% Confidence Interval: [0.138, 0.151]</span></span></code></pre>
<p>Finally, to demonstrate why this might be useful, the following
estimates the required sample size to achieve 80% power when using a 95%
HDI-ROPE criteria.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rope.lm</span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="../reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">200</span><span class="op">)</span>, beta0<span class="op">=</span><span class="fl">2</span>, beta1<span class="op">=</span><span class="fl">1</span>, sigma<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.80</span>, sig.level<span class="op">=</span><span class="fl">.95</span>, sig.direction<span class="op">=</span><span class="st">'above'</span>, parallel<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Execution time (H:M:S): 00:14:53</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##       n beta0 beta1 sig.level power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>     2     1      0.95   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 107.7</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [106.7, 108.7]</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
