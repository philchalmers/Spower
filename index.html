<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Power Analyses using Monte Carlo Simulations • Spower</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Power Analyses using Monte Carlo Simulations">
<meta name="description" content="Provides a general purpose simulation-based power analysis API for routine and customized simulation experimental designs. The package focuses exclusively on Monte Carlo simulation experiment variants of (expected) prospective power analyses, criterion analyses, compromise analyses, sensitivity analyses, and a priori/post-hoc analyses. The default simulation experiment functions defined within the package provide stochastic variants of the power analysis subroutines in G*Power 3.1 (Faul, Erdfelder, Buchner, and Lang, 2009) &lt;doi:10.3758/brm.41.4.1149&gt;, along with various other parametric and non-parametric power analysis applications (e.g., mediation analyses) and support for Bayesian power analysis by way of Bayes factors or posterior probability evaluations. Additional functions for building empirical power curves, reanalyzing simulation information, and for increasing the precision of the resulting power estimates are also included, each of which utilize similar API structures. For further details see the associated publication in Chalmers (2025) &lt;doi:10.3758/s13428-025-02787-z&gt;.">
<meta property="og:description" content="Provides a general purpose simulation-based power analysis API for routine and customized simulation experimental designs. The package focuses exclusively on Monte Carlo simulation experiment variants of (expected) prospective power analyses, criterion analyses, compromise analyses, sensitivity analyses, and a priori/post-hoc analyses. The default simulation experiment functions defined within the package provide stochastic variants of the power analysis subroutines in G*Power 3.1 (Faul, Erdfelder, Buchner, and Lang, 2009) &lt;doi:10.3758/brm.41.4.1149&gt;, along with various other parametric and non-parametric power analysis applications (e.g., mediation analyses) and support for Bayesian power analysis by way of Bayes factors or posterior probability evaluations. Additional functions for building empirical power curves, reanalyzing simulation information, and for increasing the precision of the resulting power estimates are also included, each of which utilize similar API structures. For further details see the associated publication in Chalmers (2025) &lt;doi:10.3758/s13428-025-02787-z&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">Spower</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/gpower_examples.html">G*Power examples evaluated with Spower</a></li>
    <li><a class="dropdown-item" href="articles/original/gpower_examples.html">G*Power examples evaluated with Spower</a></li>
    <li><a class="dropdown-item" href="articles/Spower_TypeSM.html">Type M and Type S errors</a></li>
    <li><a class="dropdown-item" href="articles/SpowerIntro_logicals.html">Logical Vectors, Bayesian power analyses, and ROPEs</a></li>
    <li><a class="dropdown-item" href="articles/SpowerIntro.html">Introduction to the Spower package</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/Spower/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="spower-power-analyses-using-monte-carlo-simulations-">
<em>Spower</em>: Power Analyses using Monte Carlo Simulations <img src="inst/sticker/S.png" height="139" align="right"><a class="anchor" aria-label="anchor" href="#spower-power-analyses-using-monte-carlo-simulations-"></a>
</h1></div>
<p><em>Spower</em> Provides a general purpose simulation-based power analysis API for routine and customized simulation experimental designs. The package focuses exclusively on Monte Carlo simulation experiment variants of (expected) prospective power analyses, criterion analyses, compromise analyses, sensitivity analyses, and a priori/post-hoc analyses. The default simulation experiment functions defined within the package provide stochastic variants of the power analysis subroutines in <em>GPower</em> 3.1 (Faul, Erdfelder, Buchner, and Lang, 2009), along with various other parametric and non-parametric power analysis applications (e.g., mediation analyses) and support for Bayesian power analysis by way of Bayes factors or posterior probability evaluations. Additional functions for building empirical power curves, reanalyzing simulation information, and for increasing the precision of the resulting power estimates are also included, each of which utilize similar API structures. For further details see the associated publication in Chalmers (2025).</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install <code>Spower</code> from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"Spower"</span><span class="op">)</span></span></code></pre></div>
<p>To install the development version of the <code>Spower</code> package, you need to install the <code>remotes</code> package then the <code>Spower</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"philchalmers/Spower"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p><em>Spower</em> requires only two components: an available function used to generate exactly one simulation experiment that returns one or more <em>p</em>-values given the null hypothesis of interest (or alternative criteria that return <code>logical</code> indicators or posterior probabilities), and the use of either <code><a href="reference/Spower.html">Spower()</a></code> or <code><a href="reference/Spower.html">SpowerCurve()</a></code> to perform the desired prospective/post-hoc, a priori, sensitivity, compromise, or criterion power analysis.</p>
<p>For example, the built-in <code><a href="reference/p_t.test.html">p_t.test()</a></code> function performs <em>t</em>-tests using various inputs, where below a sample size of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N=200</annotation></semantics></math> is supplied (<code>n = 100</code> per group) and a Cohen’s <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math> of .5 (a so-called “medium” effect). This returns a single <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value given the null hypotheses of no mean difference, which in this single case returns a ‘surprising’ result given this null position tested.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://philchalmers.github.io/Spower/">Spower</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, d<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.001231514</span></span></code></pre></div>
<p>To evaluate the prospective power of this test simply requires passing the simulation function to <code><a href="reference/Spower.html">Spower()</a></code>, which will perform this experiment with 10,000 independent replications, collecting and summarizing all relevant information for the power analysis.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, d<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/Spower.html">Spower</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:02</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">##</span></span>
<span><span class="co">## # A tibble: 1 × 4</span></span>
<span><span class="co">##       n     d sig.level power</span></span>
<span><span class="co">##   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;</span></span>
<span><span class="co">## 1   100   0.5      0.05 NA   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of power: 0.943</span></span>
<span><span class="co">## 95% Confidence Interval: [0.938, 0.947]</span></span></code></pre></div>
<p>Alternatively, for a priori and sensitive analyses, the respective input to the simulation function must be set to <code>NA</code>, while within <code><a href="reference/Spower.html">Spower()</a></code> the target power rate must be included along with a suitable search <code>interval</code> range. Below the target power is set to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>β</mi><mo>=</mo><mn>.95</mn></mrow><annotation encoding="application/x-tex">1-\beta = .95</annotation></semantics></math>, while the associated <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> is suspected to lay somewhere within the boundary <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>50</mn><mo>,</mo><mn>300</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[50,300]</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">01123581321</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># estimate the require n value to achieve a power of 1 - beta = .95 </span></span>
<span><span class="fu"><a href="reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="cn">NA</span>, d<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.95</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Iter: 56; Median = 101; E(f(x)) = 0.00; Total.reps = 11000; k.tol = 2; Pred = 103.4</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Execution time (H:M:S): 00:00:05</span></span>
<span><span class="co">## Design conditions: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## # A tibble: 1 × 4</span></span>
<span><span class="co">##       n     d sig.level power</span></span>
<span><span class="co">##   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">## 1    NA   0.5      0.05  0.95</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimate of n: 103.4</span></span>
<span><span class="co">## 95% Predicted Confidence Interval: [101.5, 105.4]</span></span></code></pre></div>
<p>Equivalently, the function <code><a href="reference/Spower.html">interval()</a></code> can be used instead of placing the interval range within <code><a href="reference/Spower.html">Spower()</a></code>. Below will provide the same stochastic root finding task.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using interval() function instead</span></span>
<span><span class="fu"><a href="reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="reference/Spower.html">interval</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">300</span><span class="op">)</span>, d<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/Spower.html">Spower</a></span><span class="op">(</span>power<span class="op">=</span><span class="fl">.95</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimated-power-curves">Estimated power curves<a class="anchor" aria-label="anchor" href="#estimated-power-curves"></a>
</h2>
<p>To generate suitable power-curves for any given simulation or power analysis criteria, the simulation experiment can be passed to <code><a href="reference/Spower.html">SpowerCurve()</a></code> (or to <code><a href="reference/Spower.html">SpowerBatch()</a></code> first, and then to <code><a href="reference/Spower.html">SpowerCurve()</a></code>). This function contains a similar specification structure to <code><a href="reference/Spower.html">Spower()</a></code>, however differs in that the arguments to vary are explicitly passed as named vectors to <code><a href="reference/Spower.html">SpowerCurve()</a></code>. Below is an example varying sample size (<code>n</code>), while the next example varies both <code>n</code> and the effect size <code>d</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">8675309</span><span class="op">)</span> <span class="co"># Jenny Jenny</span></span>
<span><span class="fu"><a href="reference/p_t.test.html">p_t.test</a></span><span class="op">(</span>d<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/Spower.html">SpowerCurve</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">550</span>, by<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png"><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/p_t.test.html">p_t.test</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/Spower.html">SpowerCurve</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">350</span>, by<span class="op">=</span><span class="fl">50</span><span class="op">)</span>, d<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.3</span>, <span class="fl">.4</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="vignettes">Vignettes<a class="anchor" aria-label="anchor" href="#vignettes"></a>
</h2>
<p>The package currently contains a vignette demonstrating several of the examples from the <em>GPower 3.1</em> manual, providing simulation-based replications of the same analyses, as well other vignettes showing more advanced applications of the package (ROPEs, Bayesian power analyses, precision criterion, Type S/M errors, etc).</p>
</div>
<div class="section level2">
<h2 id="getting-help-or-reporting-an-issue">Getting Help or Reporting an Issue<a class="anchor" aria-label="anchor" href="#getting-help-or-reporting-an-issue"></a>
</h2>
<p>To report bugs/issues/feature requests, please file an <a href="https://github.com/philchalmers/Spower/issues/" class="external-link">issue</a>.</p>
</div>
<div class="section level2">
<h2 id="how-to-contribute">How to Contribute<a class="anchor" aria-label="anchor" href="#how-to-contribute"></a>
</h2>
<p>If you have a simulation experiment you’d like to contribute in the form of either</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># returns a p-value, P(D|H0)</span></span>
<span><span class="fu">p_yourSimulation</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># returns a posterior probability, P(H1|D)</span></span>
<span><span class="fu">pp_yourSimulation</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># returns a logical (more complex experiments, perhaps involing ROPEs)</span></span>
<span><span class="fu">l_yourSimulation</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>then feel free to document this function using the <code>roxygen2</code> style syntax and open a pull request. Otherwise, contributions can be made to the online Wiki.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=Spower" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/philchalmers/Spower/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/philchalmers/Spower/issues?state=open" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing Spower</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Phil Chalmers <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5332-2810" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-pkg.org:443/pkg/Spower" class="external-link"><img src="http://www.r-pkg.org/badges/version/Spower"></a></li>
<li><a href="https://CRAN.R-project.org/package=Spower" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/Spower"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
